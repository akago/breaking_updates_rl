{
    "absolute_path_to_file_in_container": "/ecaudit/eclog/src/main/java/com/ericsson/bss/cassandra/ecaudit/eclog/config/EcLogYamlConfigLoader.java",
    "errors": [
        {
            "line_number": 62,
            "message": "[ERROR] /ecaudit/eclog/src/main/java/com/ericsson/bss/cassandra/ecaudit/eclog/config/EcLogYamlConfigLoader.java:[62,87] incompatible types: java.lang.Class<com.ericsson.bss.cassandra.ecaudit.eclog.config.EcLogYamlConfig> cannot be converted to java.lang.ClassLoader",
            "additional_info": "",
            "file_name": "EcLogYamlConfigLoader.java",
            "BCs": [],
            "Additions": [
                "++ public Yaml org.yaml.snakeyaml.Yaml(org.yaml.snakeyaml.LoaderOptions,org.yaml.snakeyaml.DumperOptions)"
            ],
            "uid": "636b2815-6251-56de-b7a2-17e9bfa20dc3"
        }
    ],
    "prompt": "\nThe following Java client code fails: \n'''java\n/*\n * Copyright 2019 Telefonaktiebolaget LM Ericsson\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\npackage com.ericsson.bss.cassandra.ecaudit.eclog.config;\n\nimport java.io.IOException;\nimport java.nio.file.Files;\nimport java.nio.file.Path;\nimport java.nio.file.Paths;\nimport java.util.ArrayList;\nimport java.util.List;\n\nimport com.ericsson.bss.cassandra.ecaudit.eclog.ToolOptions;\n\nimport org.yaml.snakeyaml.Yaml;\nimport org.yaml.snakeyaml.constructor.CustomClassLoaderConstructor;\nimport org.yaml.snakeyaml.constructor.SafeConstructor;\nimport org.yaml.snakeyaml.error.YAMLException;\n\npublic final class EcLogYamlConfigLoader\n{\n    private static final EcLogYamlConfig DEFAULT_CONFIG = new EcLogYamlConfig();\n    private static final String FILE_NAME = \"eclog.yaml\";\n\n    private EcLogYamlConfigLoader()\n    {\n        // static class\n    }\n\n    public static EcLogYamlConfig load(ToolOptions options)\n    {\n        return getConfigFileLocations(options).stream()\n                                              .filter(Files::isReadable)\n                                              .map(EcLogYamlConfigLoader::loadConfigFromUrl)\n                                              .findFirst()\n                                              .orElse(DEFAULT_CONFIG); // No config file - use default\n    }\n\n    static List<Path> getConfigFileLocations(ToolOptions options)\n    {\n        List<Path> paths = new ArrayList<>();\n        options.config().ifPresent(paths::add); // First - (optionally) specified at command line\n        paths.add(Paths.get(System.getProperty(\"user.dir\"), FILE_NAME)); // Second - working directory\n        paths.add(options.path().resolve(FILE_NAME)); // Third - same directory as chronicle files\n        return paths;\n    }\n\n    static EcLogYamlConfig loadConfigFromUrl(Path filePath)\n    {\n        SafeConstructor constructor = new CustomClassLoaderConstructor(EcLogYamlConfig.class, Thread.currentThread().getContextClassLoader());\n        Yaml yaml = new Yaml(constructor);\n        try\n        {\n            String fileAsString = new String(Files.readAllBytes(filePath));\n            EcLogYamlConfig auditYamlConfig = (EcLogYamlConfig) yaml.load(fileAsString);\n            return auditYamlConfig == null\n                   ? new EcLogYamlConfig() // File is valid but empty\n                   : auditYamlConfig;\n        }\n        catch (YAMLException | IOException e)\n        {\n            throw new IllegalArgumentException(\"Invalid configuration file: \" + filePath, e);\n        }\n    }\n}\n\n'''\nThe error is caused by a change in the API of the dependency: snakeyaml 1.33->2.4. \nThe new library version includes the following relevant backward incompatible changes on API. \n(API changes format: lines starting with '--' denote removed members, '++' denote added ones, '~~' denote mutations with change kind) \n++ public Yaml org.yaml.snakeyaml.Yaml(org.yaml.snakeyaml.LoaderOptions,org.yaml.snakeyaml.DumperOptions)\n\nThe error is triggered in the following specific lines in the previous code:\n        SafeConstructor constructor = new CustomClassLoaderConstructor(EcLogYamlConfig.class, Thread.currentThread().getContextClassLoader());\nwith the following error message:\n[ERROR] /ecaudit/eclog/src/main/java/com/ericsson/bss/cassandra/ecaudit/eclog/config/EcLogYamlConfigLoader.java:[62,87] incompatible types: java.lang.Class<com.ericsson.bss.cassandra.ecaudit.eclog.config.EcLogYamlConfig> cannot be converted to java.lang.ClassLoader\n\nPlease apply your reasoning and generate the fix following the system instruction.\n",
    "buggy_lines": "        SafeConstructor constructor = new CustomClassLoaderConstructor(EcLogYamlConfig.class, Thread.currentThread().getContextClassLoader());",
    "error_message": "[ERROR] /ecaudit/eclog/src/main/java/com/ericsson/bss/cassandra/ecaudit/eclog/config/EcLogYamlConfigLoader.java:[62,87] incompatible types: java.lang.Class<com.ericsson.bss.cassandra.ecaudit.eclog.config.EcLogYamlConfig> cannot be converted to java.lang.ClassLoader",
    "api_diff": "++ public Yaml org.yaml.snakeyaml.Yaml(org.yaml.snakeyaml.LoaderOptions,org.yaml.snakeyaml.DumperOptions)",
    "original_code": "/*\n * Copyright 2019 Telefonaktiebolaget LM Ericsson\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\npackage com.ericsson.bss.cassandra.ecaudit.eclog.config;\n\nimport java.io.IOException;\nimport java.nio.file.Files;\nimport java.nio.file.Path;\nimport java.nio.file.Paths;\nimport java.util.ArrayList;\nimport java.util.List;\n\nimport com.ericsson.bss.cassandra.ecaudit.eclog.ToolOptions;\n\nimport org.yaml.snakeyaml.Yaml;\nimport org.yaml.snakeyaml.constructor.CustomClassLoaderConstructor;\nimport org.yaml.snakeyaml.constructor.SafeConstructor;\nimport org.yaml.snakeyaml.error.YAMLException;\n\npublic final class EcLogYamlConfigLoader\n{\n    private static final EcLogYamlConfig DEFAULT_CONFIG = new EcLogYamlConfig();\n    private static final String FILE_NAME = \"eclog.yaml\";\n\n    private EcLogYamlConfigLoader()\n    {\n        // static class\n    }\n\n    public static EcLogYamlConfig load(ToolOptions options)\n    {\n        return getConfigFileLocations(options).stream()\n                                              .filter(Files::isReadable)\n                                              .map(EcLogYamlConfigLoader::loadConfigFromUrl)\n                                              .findFirst()\n                                              .orElse(DEFAULT_CONFIG); // No config file - use default\n    }\n\n    static List<Path> getConfigFileLocations(ToolOptions options)\n    {\n        List<Path> paths = new ArrayList<>();\n        options.config().ifPresent(paths::add); // First - (optionally) specified at command line\n        paths.add(Paths.get(System.getProperty(\"user.dir\"), FILE_NAME)); // Second - working directory\n        paths.add(options.path().resolve(FILE_NAME)); // Third - same directory as chronicle files\n        return paths;\n    }\n\n    static EcLogYamlConfig loadConfigFromUrl(Path filePath)\n    {\n        SafeConstructor constructor = new CustomClassLoaderConstructor(EcLogYamlConfig.class, Thread.currentThread().getContextClassLoader());\n        Yaml yaml = new Yaml(constructor);\n        try\n        {\n            String fileAsString = new String(Files.readAllBytes(filePath));\n            EcLogYamlConfig auditYamlConfig = (EcLogYamlConfig) yaml.load(fileAsString);\n            return auditYamlConfig == null\n                   ? new EcLogYamlConfig() // File is valid but empty\n                   : auditYamlConfig;\n        }\n        catch (YAMLException | IOException e)\n        {\n            throw new IllegalArgumentException(\"Invalid configuration file: \" + filePath, e);\n        }\n    }\n}\n",
    "project": "ecaudit",
    "libraryName": "snakeyaml",
    "libraryGroupID": "org.yaml",
    "newVersion": "2.4",
    "previousVersion": "1.33",
    "breakingCommit": "db035d7674422ccff83c99683edae833bef190a8"
}