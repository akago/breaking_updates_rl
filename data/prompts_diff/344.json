{
    "absolute_path_to_file_in_container": "/license-maven-plugin/license-maven-plugin/src/test/java/com/mycila/maven/plugin/license/RemoveMojoTest.java",
    "errors": [
        {
            "line_number": 20,
            "message": "[ERROR] /license-maven-plugin/license-maven-plugin/src/test/java/com/mycila/maven/plugin/license/RemoveMojoTest.java:[20,45] package org.apache.maven.plugin.testing.stubs does not exist",
            "additional_info": "",
            "file_name": "RemoveMojoTest.java",
            "BCs": [],
            "Additions": [],
            "uid": "9d2a3462-9c5e-58f7-b1c4-0115d377857b"
        },
        {
            "line_number": 42,
            "message": "[ERROR] /license-maven-plugin/license-maven-plugin/src/test/java/com/mycila/maven/plugin/license/RemoveMojoTest.java:[42,26] cannot find symbol",
            "additional_info": "  symbol:   class MavenProjectStub\n  location: class com.mycila.maven.plugin.license.RemoveMojoTest",
            "file_name": "RemoveMojoTest.java",
            "BCs": [
                {
                    "element": "org.apache.maven.plugin.testing.stubs.MavenProjectStub",
                    "nature": "DELETION",
                    "kind": "TYPE_REMOVED"
                }
            ],
            "Additions": [],
            "uid": "9e2b4377-c167-5b8d-8f19-7d271fedd716"
        },
        {
            "line_number": 59,
            "message": "[ERROR] /license-maven-plugin/license-maven-plugin/src/test/java/com/mycila/maven/plugin/license/RemoveMojoTest.java:[59,26] cannot find symbol",
            "additional_info": "  symbol:   class MavenProjectStub\n  location: class com.mycila.maven.plugin.license.RemoveMojoTest",
            "file_name": "RemoveMojoTest.java",
            "BCs": [
                {
                    "element": "org.apache.maven.plugin.testing.stubs.MavenProjectStub",
                    "nature": "DELETION",
                    "kind": "TYPE_REMOVED"
                }
            ],
            "Additions": [],
            "uid": "9e2b4377-c167-5b8d-8f19-7d271fedd716"
        },
        {
            "line_number": 83,
            "message": "[ERROR] /license-maven-plugin/license-maven-plugin/src/test/java/com/mycila/maven/plugin/license/RemoveMojoTest.java:[83,26] cannot find symbol",
            "additional_info": "  symbol:   class MavenProjectStub\n  location: class com.mycila.maven.plugin.license.RemoveMojoTest",
            "file_name": "RemoveMojoTest.java",
            "BCs": [
                {
                    "element": "org.apache.maven.plugin.testing.stubs.MavenProjectStub",
                    "nature": "DELETION",
                    "kind": "TYPE_REMOVED"
                }
            ],
            "Additions": [],
            "uid": "9e2b4377-c167-5b8d-8f19-7d271fedd716"
        },
        {
            "line_number": 100,
            "message": "[ERROR] /license-maven-plugin/license-maven-plugin/src/test/java/com/mycila/maven/plugin/license/RemoveMojoTest.java:[100,26] cannot find symbol",
            "additional_info": "  symbol:   class MavenProjectStub\n  location: class com.mycila.maven.plugin.license.RemoveMojoTest",
            "file_name": "RemoveMojoTest.java",
            "BCs": [
                {
                    "element": "org.apache.maven.plugin.testing.stubs.MavenProjectStub",
                    "nature": "DELETION",
                    "kind": "TYPE_REMOVED"
                }
            ],
            "Additions": [],
            "uid": "9e2b4377-c167-5b8d-8f19-7d271fedd716"
        },
        {
            "line_number": 117,
            "message": "[ERROR] /license-maven-plugin/license-maven-plugin/src/test/java/com/mycila/maven/plugin/license/RemoveMojoTest.java:[117,26] cannot find symbol",
            "additional_info": "  symbol:   class MavenProjectStub\n  location: class com.mycila.maven.plugin.license.RemoveMojoTest",
            "file_name": "RemoveMojoTest.java",
            "BCs": [
                {
                    "element": "org.apache.maven.plugin.testing.stubs.MavenProjectStub",
                    "nature": "DELETION",
                    "kind": "TYPE_REMOVED"
                }
            ],
            "Additions": [],
            "uid": "9e2b4377-c167-5b8d-8f19-7d271fedd716"
        },
        {
            "line_number": 136,
            "message": "[ERROR] /license-maven-plugin/license-maven-plugin/src/test/java/com/mycila/maven/plugin/license/RemoveMojoTest.java:[136,26] cannot find symbol",
            "additional_info": "  symbol:   class MavenProjectStub\n  location: class com.mycila.maven.plugin.license.RemoveMojoTest",
            "file_name": "RemoveMojoTest.java",
            "BCs": [
                {
                    "element": "org.apache.maven.plugin.testing.stubs.MavenProjectStub",
                    "nature": "DELETION",
                    "kind": "TYPE_REMOVED"
                }
            ],
            "Additions": [],
            "uid": "9e2b4377-c167-5b8d-8f19-7d271fedd716"
        },
        {
            "line_number": 156,
            "message": "[ERROR] /license-maven-plugin/license-maven-plugin/src/test/java/com/mycila/maven/plugin/license/RemoveMojoTest.java:[156,26] cannot find symbol",
            "additional_info": "  symbol:   class MavenProjectStub\n  location: class com.mycila.maven.plugin.license.RemoveMojoTest",
            "file_name": "RemoveMojoTest.java",
            "BCs": [
                {
                    "element": "org.apache.maven.plugin.testing.stubs.MavenProjectStub",
                    "nature": "DELETION",
                    "kind": "TYPE_REMOVED"
                }
            ],
            "Additions": [],
            "uid": "9e2b4377-c167-5b8d-8f19-7d271fedd716"
        },
        {
            "line_number": 176,
            "message": "[ERROR] /license-maven-plugin/license-maven-plugin/src/test/java/com/mycila/maven/plugin/license/RemoveMojoTest.java:[176,26] cannot find symbol",
            "additional_info": "  symbol:   class MavenProjectStub\n  location: class com.mycila.maven.plugin.license.RemoveMojoTest",
            "file_name": "RemoveMojoTest.java",
            "BCs": [
                {
                    "element": "org.apache.maven.plugin.testing.stubs.MavenProjectStub",
                    "nature": "DELETION",
                    "kind": "TYPE_REMOVED"
                }
            ],
            "Additions": [],
            "uid": "9e2b4377-c167-5b8d-8f19-7d271fedd716"
        },
        {
            "line_number": 183,
            "message": "[ERROR] /license-maven-plugin/license-maven-plugin/src/test/java/com/mycila/maven/plugin/license/RemoveMojoTest.java:[183,26] cannot find symbol",
            "additional_info": "  symbol:   class MavenProjectStub\n  location: class com.mycila.maven.plugin.license.RemoveMojoTest",
            "file_name": "RemoveMojoTest.java",
            "BCs": [
                {
                    "element": "org.apache.maven.plugin.testing.stubs.MavenProjectStub",
                    "nature": "DELETION",
                    "kind": "TYPE_REMOVED"
                }
            ],
            "Additions": [],
            "uid": "9e2b4377-c167-5b8d-8f19-7d271fedd716"
        }
    ],
    "prompt": "\nThe following Java client code fails: \n'''java\n/**\n * Copyright (C) 2008 Mycila (mathieu.carbou@gmail.com)\n * <p>\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n * <p>\n * http://www.apache.org/licenses/LICENSE-2.0\n * <p>\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\npackage com.mycila.maven.plugin.license;\n\nimport com.google.common.io.Files;\nimport com.mycila.maven.plugin.license.util.FileUtils;\nimport org.apache.maven.plugin.testing.stubs.MavenProjectStub;\nimport org.junit.jupiter.api.Assertions;\nimport org.junit.jupiter.api.Test;\n\nimport java.io.File;\nimport java.nio.charset.Charset;\nimport java.nio.charset.StandardCharsets;\nimport java.util.List;\n\nfinal class RemoveMojoTest {\n  public static final String LS = \"\\n\";\n\n  @Test\n  void test_remove() throws Exception {\n    File tmp = new File(\"target/test/remove/txt\");\n    tmp.mkdirs();\n    FileUtils.copyFileToFolder(new File(\"src/test/resources/remove/doc1.txt\"), tmp);\n    FileUtils.copyFileToFolder(new File(\"src/test/resources/remove/doc2.txt\"), tmp);\n\n    LicenseRemoveMojo remove = new LicenseRemoveMojo();\n    remove.defaultBasedir = tmp;\n    remove.legacyConfigHeader = \"src/test/resources/remove/header.txt\";\n    remove.project = new MavenProjectStub();\n    remove.execute();\n\n    Assertions.assertEquals(\"some data\\r\\nand other data\\r\\n\", FileUtils.read(new File(tmp, \"doc1.txt\"), Charset.defaultCharset()));\n    Assertions.assertEquals(\"some data\\r\\nand other data\\r\\n\", FileUtils.read(new File(tmp, \"doc2.txt\"), Charset.defaultCharset()));\n  }\n\n  @Test\n  void test_remove_xml_txt() throws Exception {\n    File tmp = new File(\"target/test/remove/other\");\n    tmp.mkdirs();\n    FileUtils.copyFileToFolder(new File(\"src/test/resources/doc/doc9.xml\"), tmp);\n    FileUtils.copyFileToFolder(new File(\"src/test/resources/doc/doc3.txt\"), tmp);\n\n    LicenseRemoveMojo remove = new LicenseRemoveMojo();\n    remove.defaultBasedir = tmp;\n    remove.legacyConfigHeader = \"src/test/resources/remove/header.txt\";\n    remove.project = new MavenProjectStub();\n    remove.execute();\n\n    Assertions.assertEquals(\"<?xml version=\\\"1.0\\\" encoding=\\\"ISO-8859-1\\\"?>\\r\\n\" +\n        \"\\r\\n\" +\n        \"\\r\\n\" +\n        \"\\r\\n\" +\n        \"<web-app>\\r\\n\" +\n        \"\\r\\n\" +\n        \"</web-app>\\r\\n\", FileUtils.read(new File(tmp, \"doc9.xml\"), Charset.defaultCharset()));\n    Assertions.assertEquals(\"some data\\r\\nand other data\\r\\n\", FileUtils.read(new File(tmp, \"doc3.txt\"), Charset.defaultCharset()));\n  }\n\n  @Test\n  void test_remove_script_style() throws Exception {\n    File tmp = new File(\"target/test/remove/issue44\");\n    tmp.mkdirs();\n    FileUtils.copyFileToFolder(new File(\"src/test/resources/remove/issue44.rb\"), tmp);\n    FileUtils.copyFileToFolder(new File(\"src/test/resources/remove/issue44-2.rb\"), tmp);\n    FileUtils.copyFileToFolder(new File(\"src/test/resources/remove/issue44-3.rb\"), tmp);\n\n    LicenseRemoveMojo remove = new LicenseRemoveMojo();\n    remove.defaultBasedir = tmp;\n    remove.legacyConfigHeader = \"src/test/resources/remove/header.txt\";\n    remove.project = new MavenProjectStub();\n    remove.execute();\n\n    Assertions.assertEquals(\"ruby code here\" + LS + \"and other data\" + LS + \"\", FileUtils.read(new File(tmp, \"issue44.rb\"), Charset.defaultCharset()));\n    Assertions.assertEquals(\"# code comment\" + LS + \"ruby code here\" + LS + \"and other data\" + LS + \"\", FileUtils.read(new File(tmp, \"issue44-2.rb\"), Charset.defaultCharset()));\n    Assertions.assertEquals(\"# code comment\" + LS + \"ruby code here\" + LS + \"and other data\" + LS + \"\", FileUtils.read(new File(tmp, \"issue44-3.rb\"), Charset.defaultCharset()));\n  }\n\n  @Test\n  void test_remove_multiline() throws Exception {\n    File tmp = new File(\"target/test/remove/multi\");\n    tmp.mkdirs();\n    FileUtils.copyFileToFolder(new File(\"src/test/resources/remove/test.xml\"), tmp);\n\n    LicenseRemoveMojo remove = new LicenseRemoveMojo();\n    remove.defaultBasedir = tmp;\n    remove.legacyConfigHeader = \"src/test/resources/remove/header.txt\";\n    remove.project = new MavenProjectStub();\n    remove.execute();\n\n    Assertions.assertEquals(\"<assembly>\" + LS + \"\" +\n        \"  <id>project</id>\" + LS + \"\" +\n        \"</assembly>\" + LS + \"\", FileUtils.read(new File(tmp, \"test.xml\"), Charset.defaultCharset()));\n  }\n\n  @Test\n  void test_js_1() throws Exception {\n    File tmp = new File(\"target/test/remove/js\");\n    tmp.mkdirs();\n    FileUtils.copyFileToFolder(new File(\"src/test/resources/remove/test1.js\"), tmp);\n\n    LicenseRemoveMojo remove = new LicenseRemoveMojo();\n    remove.defaultBasedir = tmp;\n    remove.legacyConfigHeader = \"src/test/resources/remove/header.txt\";\n    remove.project = new MavenProjectStub();\n    remove.execute();\n\n    Assertions.assertEquals(\"/**\" + LS + \"\" +\n        \" * jrunscript JavaScript built-in functions and objects.\" + LS + \"\" +\n        \" */\" + LS + \"\" +\n        \"\" + LS + \"\" +\n        \"function a(){}\", FileUtils.read(new File(tmp, \"test1.js\"), Charset.defaultCharset()).trim());\n  }\n\n  @Test\n  void test_js_2() throws Exception {\n    File tmp = new File(\"target/test/remove/js\");\n    tmp.mkdirs();\n    FileUtils.copyFileToFolder(new File(\"src/test/resources/remove/test2.js\"), tmp);\n\n    LicenseRemoveMojo remove = new LicenseRemoveMojo();\n    remove.defaultBasedir = tmp;\n    remove.legacyConfigHeader = \"src/test/resources/remove/header.txt\";\n    remove.project = new MavenProjectStub();\n    remove.execute();\n\n    Assertions.assertEquals(\"/**\" + LS + \"\" +\n        \" * jrunscript JavaScript built-in functions and objects.\" + LS + \"\" +\n        \" */\" + LS + \"\" +\n        \"\" + LS + \"\" +\n        \"function a(){}\", FileUtils.read(new File(tmp, \"test2.js\"), Charset.defaultCharset()).trim());\n  }\n\n  @Test\n  void test_issue30_RemoveSucceedsOnAOneLineCommentFile() throws Exception {\n    File tmp = new File(\"target/test/remove/issue30\");\n    tmp.mkdirs();\n    FileUtils.copyFileToFolder(new File(\"src/test/resources/remove/issue-30/one-line-comment.java\"), tmp);\n    FileUtils.copyFileToFolder(new File(\"src/test/resources/remove/issue-30/one-line-comment.ftl\"), tmp);\n\n    LicenseRemoveMojo remove = new LicenseRemoveMojo();\n    remove.defaultBasedir = tmp;\n    remove.legacyConfigHeader = \"src/test/resources/remove/header.txt\";\n    remove.project = new MavenProjectStub();\n    remove.execute();\n\n    // NPE was thrown in issue-30, let junit check that no Exception is thrown\n  }\n\n  @Test\n  void test_issue41_cannotRemoveEmptyHeader() throws Exception {\n    File tmp = new File(\"target/test/remove/issue41\");\n    tmp.mkdirs();\n    FileUtils.copyFileToFolder(new File(\"src/test/resources/remove/issue-41/ASimpleClass.java\"), tmp);\n    final File destFile = new File(tmp, \"ASimpleClass.java\");\n\n    List<String> initialLines = Files.readLines(destFile, StandardCharsets.UTF_8);\n    org.assertj.core.api.Assertions.assertThat(initialLines).hasSize(2);\n\n    // Let's apply the licene\n    LicenseFormatMojo format = new LicenseFormatMojo();\n    format.defaultBasedir = tmp;\n    format.legacyConfigHeader = \"com/mycila/maven/plugin/license/templates/GPL-3.txt\";\n    format.project = new MavenProjectStub();\n    format.execute();\n\n    // Let's try to remove it\n    LicenseRemoveMojo remove = new LicenseRemoveMojo();\n    remove.defaultBasedir = tmp;\n    remove.legacyConfigHeader = \"com/mycila/maven/plugin/license/templates/GPL-3.txt\";\n    remove.project = new MavenProjectStub();\n//        remove.keywords = new String[]{\"GNU\"};\n    remove.execute();\n\n    List<String> linesAfterRemove = Files.readLines(destFile, StandardCharsets.UTF_8);\n    org.assertj.core.api.Assertions.assertThat(linesAfterRemove).hasSize(2);\n  }\n}\n\n'''\nThe error is caused by a change in the API of the dependency: maven-plugin-testing-harness 4.0.0-alpha-2->4.0.0-beta-3. \nThe new library version includes the following relevant backward incompatible changes on API. \n(API changes format: lines starting with '--' denote removed members, '++' denote added ones, '~~' denote mutations with change kind) \n-- org.apache.maven.plugin.testing.stubs.MavenProjectStub\n-- org.apache.maven.plugin.testing.stubs.ArtifactStub\n\nThe error is triggered in the following specific lines in the previous code:\nimport org.apache.maven.plugin.testing.stubs.MavenProjectStub;\n    remove.project = new MavenProjectStub();\n    remove.project = new MavenProjectStub();\n    remove.project = new MavenProjectStub();\n    remove.project = new MavenProjectStub();\n    remove.project = new MavenProjectStub();\n    remove.project = new MavenProjectStub();\n    remove.project = new MavenProjectStub();\n    format.project = new MavenProjectStub();\n    remove.project = new MavenProjectStub();\nwith the following error message:\n[ERROR] /license-maven-plugin/license-maven-plugin/src/test/java/com/mycila/maven/plugin/license/RemoveMojoTest.java:[20,45] package org.apache.maven.plugin.testing.stubs does not exist\n[ERROR] /license-maven-plugin/license-maven-plugin/src/test/java/com/mycila/maven/plugin/license/RemoveMojoTest.java:[42,26] cannot find symbol  symbol:   class MavenProjectStub\n  location: class com.mycila.maven.plugin.license.RemoveMojoTest\n[ERROR] /license-maven-plugin/license-maven-plugin/src/test/java/com/mycila/maven/plugin/license/RemoveMojoTest.java:[59,26] cannot find symbol  symbol:   class MavenProjectStub\n  location: class com.mycila.maven.plugin.license.RemoveMojoTest\n[ERROR] /license-maven-plugin/license-maven-plugin/src/test/java/com/mycila/maven/plugin/license/RemoveMojoTest.java:[83,26] cannot find symbol  symbol:   class MavenProjectStub\n  location: class com.mycila.maven.plugin.license.RemoveMojoTest\n[ERROR] /license-maven-plugin/license-maven-plugin/src/test/java/com/mycila/maven/plugin/license/RemoveMojoTest.java:[100,26] cannot find symbol  symbol:   class MavenProjectStub\n  location: class com.mycila.maven.plugin.license.RemoveMojoTest\n[ERROR] /license-maven-plugin/license-maven-plugin/src/test/java/com/mycila/maven/plugin/license/RemoveMojoTest.java:[117,26] cannot find symbol  symbol:   class MavenProjectStub\n  location: class com.mycila.maven.plugin.license.RemoveMojoTest\n[ERROR] /license-maven-plugin/license-maven-plugin/src/test/java/com/mycila/maven/plugin/license/RemoveMojoTest.java:[136,26] cannot find symbol  symbol:   class MavenProjectStub\n  location: class com.mycila.maven.plugin.license.RemoveMojoTest\n[ERROR] /license-maven-plugin/license-maven-plugin/src/test/java/com/mycila/maven/plugin/license/RemoveMojoTest.java:[156,26] cannot find symbol  symbol:   class MavenProjectStub\n  location: class com.mycila.maven.plugin.license.RemoveMojoTest\n[ERROR] /license-maven-plugin/license-maven-plugin/src/test/java/com/mycila/maven/plugin/license/RemoveMojoTest.java:[176,26] cannot find symbol  symbol:   class MavenProjectStub\n  location: class com.mycila.maven.plugin.license.RemoveMojoTest\n[ERROR] /license-maven-plugin/license-maven-plugin/src/test/java/com/mycila/maven/plugin/license/RemoveMojoTest.java:[183,26] cannot find symbol  symbol:   class MavenProjectStub\n  location: class com.mycila.maven.plugin.license.RemoveMojoTest\n\nPlease apply your reasoning and generate the fix following the system instruction.\n",
    "buggy_lines": "import org.apache.maven.plugin.testing.stubs.MavenProjectStub;\n    remove.project = new MavenProjectStub();\n    remove.project = new MavenProjectStub();\n    remove.project = new MavenProjectStub();\n    remove.project = new MavenProjectStub();\n    remove.project = new MavenProjectStub();\n    remove.project = new MavenProjectStub();\n    remove.project = new MavenProjectStub();\n    format.project = new MavenProjectStub();\n    remove.project = new MavenProjectStub();",
    "error_message": "[ERROR] /license-maven-plugin/license-maven-plugin/src/test/java/com/mycila/maven/plugin/license/RemoveMojoTest.java:[20,45] package org.apache.maven.plugin.testing.stubs does not exist\n[ERROR] /license-maven-plugin/license-maven-plugin/src/test/java/com/mycila/maven/plugin/license/RemoveMojoTest.java:[42,26] cannot find symbol  symbol:   class MavenProjectStub\n  location: class com.mycila.maven.plugin.license.RemoveMojoTest\n[ERROR] /license-maven-plugin/license-maven-plugin/src/test/java/com/mycila/maven/plugin/license/RemoveMojoTest.java:[59,26] cannot find symbol  symbol:   class MavenProjectStub\n  location: class com.mycila.maven.plugin.license.RemoveMojoTest\n[ERROR] /license-maven-plugin/license-maven-plugin/src/test/java/com/mycila/maven/plugin/license/RemoveMojoTest.java:[83,26] cannot find symbol  symbol:   class MavenProjectStub\n  location: class com.mycila.maven.plugin.license.RemoveMojoTest\n[ERROR] /license-maven-plugin/license-maven-plugin/src/test/java/com/mycila/maven/plugin/license/RemoveMojoTest.java:[100,26] cannot find symbol  symbol:   class MavenProjectStub\n  location: class com.mycila.maven.plugin.license.RemoveMojoTest\n[ERROR] /license-maven-plugin/license-maven-plugin/src/test/java/com/mycila/maven/plugin/license/RemoveMojoTest.java:[117,26] cannot find symbol  symbol:   class MavenProjectStub\n  location: class com.mycila.maven.plugin.license.RemoveMojoTest\n[ERROR] /license-maven-plugin/license-maven-plugin/src/test/java/com/mycila/maven/plugin/license/RemoveMojoTest.java:[136,26] cannot find symbol  symbol:   class MavenProjectStub\n  location: class com.mycila.maven.plugin.license.RemoveMojoTest\n[ERROR] /license-maven-plugin/license-maven-plugin/src/test/java/com/mycila/maven/plugin/license/RemoveMojoTest.java:[156,26] cannot find symbol  symbol:   class MavenProjectStub\n  location: class com.mycila.maven.plugin.license.RemoveMojoTest\n[ERROR] /license-maven-plugin/license-maven-plugin/src/test/java/com/mycila/maven/plugin/license/RemoveMojoTest.java:[176,26] cannot find symbol  symbol:   class MavenProjectStub\n  location: class com.mycila.maven.plugin.license.RemoveMojoTest\n[ERROR] /license-maven-plugin/license-maven-plugin/src/test/java/com/mycila/maven/plugin/license/RemoveMojoTest.java:[183,26] cannot find symbol  symbol:   class MavenProjectStub\n  location: class com.mycila.maven.plugin.license.RemoveMojoTest",
    "api_diff": "-- org.apache.maven.plugin.testing.stubs.MavenProjectStub\n-- org.apache.maven.plugin.testing.stubs.ArtifactStub",
    "original_code": "/**\n * Copyright (C) 2008 Mycila (mathieu.carbou@gmail.com)\n * <p>\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n * <p>\n * http://www.apache.org/licenses/LICENSE-2.0\n * <p>\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\npackage com.mycila.maven.plugin.license;\n\nimport com.google.common.io.Files;\nimport com.mycila.maven.plugin.license.util.FileUtils;\nimport org.apache.maven.plugin.testing.stubs.MavenProjectStub;\nimport org.junit.jupiter.api.Assertions;\nimport org.junit.jupiter.api.Test;\n\nimport java.io.File;\nimport java.nio.charset.Charset;\nimport java.nio.charset.StandardCharsets;\nimport java.util.List;\n\nfinal class RemoveMojoTest {\n  public static final String LS = \"\\n\";\n\n  @Test\n  void test_remove() throws Exception {\n    File tmp = new File(\"target/test/remove/txt\");\n    tmp.mkdirs();\n    FileUtils.copyFileToFolder(new File(\"src/test/resources/remove/doc1.txt\"), tmp);\n    FileUtils.copyFileToFolder(new File(\"src/test/resources/remove/doc2.txt\"), tmp);\n\n    LicenseRemoveMojo remove = new LicenseRemoveMojo();\n    remove.defaultBasedir = tmp;\n    remove.legacyConfigHeader = \"src/test/resources/remove/header.txt\";\n    remove.project = new MavenProjectStub();\n    remove.execute();\n\n    Assertions.assertEquals(\"some data\\r\\nand other data\\r\\n\", FileUtils.read(new File(tmp, \"doc1.txt\"), Charset.defaultCharset()));\n    Assertions.assertEquals(\"some data\\r\\nand other data\\r\\n\", FileUtils.read(new File(tmp, \"doc2.txt\"), Charset.defaultCharset()));\n  }\n\n  @Test\n  void test_remove_xml_txt() throws Exception {\n    File tmp = new File(\"target/test/remove/other\");\n    tmp.mkdirs();\n    FileUtils.copyFileToFolder(new File(\"src/test/resources/doc/doc9.xml\"), tmp);\n    FileUtils.copyFileToFolder(new File(\"src/test/resources/doc/doc3.txt\"), tmp);\n\n    LicenseRemoveMojo remove = new LicenseRemoveMojo();\n    remove.defaultBasedir = tmp;\n    remove.legacyConfigHeader = \"src/test/resources/remove/header.txt\";\n    remove.project = new MavenProjectStub();\n    remove.execute();\n\n    Assertions.assertEquals(\"<?xml version=\\\"1.0\\\" encoding=\\\"ISO-8859-1\\\"?>\\r\\n\" +\n        \"\\r\\n\" +\n        \"\\r\\n\" +\n        \"\\r\\n\" +\n        \"<web-app>\\r\\n\" +\n        \"\\r\\n\" +\n        \"</web-app>\\r\\n\", FileUtils.read(new File(tmp, \"doc9.xml\"), Charset.defaultCharset()));\n    Assertions.assertEquals(\"some data\\r\\nand other data\\r\\n\", FileUtils.read(new File(tmp, \"doc3.txt\"), Charset.defaultCharset()));\n  }\n\n  @Test\n  void test_remove_script_style() throws Exception {\n    File tmp = new File(\"target/test/remove/issue44\");\n    tmp.mkdirs();\n    FileUtils.copyFileToFolder(new File(\"src/test/resources/remove/issue44.rb\"), tmp);\n    FileUtils.copyFileToFolder(new File(\"src/test/resources/remove/issue44-2.rb\"), tmp);\n    FileUtils.copyFileToFolder(new File(\"src/test/resources/remove/issue44-3.rb\"), tmp);\n\n    LicenseRemoveMojo remove = new LicenseRemoveMojo();\n    remove.defaultBasedir = tmp;\n    remove.legacyConfigHeader = \"src/test/resources/remove/header.txt\";\n    remove.project = new MavenProjectStub();\n    remove.execute();\n\n    Assertions.assertEquals(\"ruby code here\" + LS + \"and other data\" + LS + \"\", FileUtils.read(new File(tmp, \"issue44.rb\"), Charset.defaultCharset()));\n    Assertions.assertEquals(\"# code comment\" + LS + \"ruby code here\" + LS + \"and other data\" + LS + \"\", FileUtils.read(new File(tmp, \"issue44-2.rb\"), Charset.defaultCharset()));\n    Assertions.assertEquals(\"# code comment\" + LS + \"ruby code here\" + LS + \"and other data\" + LS + \"\", FileUtils.read(new File(tmp, \"issue44-3.rb\"), Charset.defaultCharset()));\n  }\n\n  @Test\n  void test_remove_multiline() throws Exception {\n    File tmp = new File(\"target/test/remove/multi\");\n    tmp.mkdirs();\n    FileUtils.copyFileToFolder(new File(\"src/test/resources/remove/test.xml\"), tmp);\n\n    LicenseRemoveMojo remove = new LicenseRemoveMojo();\n    remove.defaultBasedir = tmp;\n    remove.legacyConfigHeader = \"src/test/resources/remove/header.txt\";\n    remove.project = new MavenProjectStub();\n    remove.execute();\n\n    Assertions.assertEquals(\"<assembly>\" + LS + \"\" +\n        \"  <id>project</id>\" + LS + \"\" +\n        \"</assembly>\" + LS + \"\", FileUtils.read(new File(tmp, \"test.xml\"), Charset.defaultCharset()));\n  }\n\n  @Test\n  void test_js_1() throws Exception {\n    File tmp = new File(\"target/test/remove/js\");\n    tmp.mkdirs();\n    FileUtils.copyFileToFolder(new File(\"src/test/resources/remove/test1.js\"), tmp);\n\n    LicenseRemoveMojo remove = new LicenseRemoveMojo();\n    remove.defaultBasedir = tmp;\n    remove.legacyConfigHeader = \"src/test/resources/remove/header.txt\";\n    remove.project = new MavenProjectStub();\n    remove.execute();\n\n    Assertions.assertEquals(\"/**\" + LS + \"\" +\n        \" * jrunscript JavaScript built-in functions and objects.\" + LS + \"\" +\n        \" */\" + LS + \"\" +\n        \"\" + LS + \"\" +\n        \"function a(){}\", FileUtils.read(new File(tmp, \"test1.js\"), Charset.defaultCharset()).trim());\n  }\n\n  @Test\n  void test_js_2() throws Exception {\n    File tmp = new File(\"target/test/remove/js\");\n    tmp.mkdirs();\n    FileUtils.copyFileToFolder(new File(\"src/test/resources/remove/test2.js\"), tmp);\n\n    LicenseRemoveMojo remove = new LicenseRemoveMojo();\n    remove.defaultBasedir = tmp;\n    remove.legacyConfigHeader = \"src/test/resources/remove/header.txt\";\n    remove.project = new MavenProjectStub();\n    remove.execute();\n\n    Assertions.assertEquals(\"/**\" + LS + \"\" +\n        \" * jrunscript JavaScript built-in functions and objects.\" + LS + \"\" +\n        \" */\" + LS + \"\" +\n        \"\" + LS + \"\" +\n        \"function a(){}\", FileUtils.read(new File(tmp, \"test2.js\"), Charset.defaultCharset()).trim());\n  }\n\n  @Test\n  void test_issue30_RemoveSucceedsOnAOneLineCommentFile() throws Exception {\n    File tmp = new File(\"target/test/remove/issue30\");\n    tmp.mkdirs();\n    FileUtils.copyFileToFolder(new File(\"src/test/resources/remove/issue-30/one-line-comment.java\"), tmp);\n    FileUtils.copyFileToFolder(new File(\"src/test/resources/remove/issue-30/one-line-comment.ftl\"), tmp);\n\n    LicenseRemoveMojo remove = new LicenseRemoveMojo();\n    remove.defaultBasedir = tmp;\n    remove.legacyConfigHeader = \"src/test/resources/remove/header.txt\";\n    remove.project = new MavenProjectStub();\n    remove.execute();\n\n    // NPE was thrown in issue-30, let junit check that no Exception is thrown\n  }\n\n  @Test\n  void test_issue41_cannotRemoveEmptyHeader() throws Exception {\n    File tmp = new File(\"target/test/remove/issue41\");\n    tmp.mkdirs();\n    FileUtils.copyFileToFolder(new File(\"src/test/resources/remove/issue-41/ASimpleClass.java\"), tmp);\n    final File destFile = new File(tmp, \"ASimpleClass.java\");\n\n    List<String> initialLines = Files.readLines(destFile, StandardCharsets.UTF_8);\n    org.assertj.core.api.Assertions.assertThat(initialLines).hasSize(2);\n\n    // Let's apply the licene\n    LicenseFormatMojo format = new LicenseFormatMojo();\n    format.defaultBasedir = tmp;\n    format.legacyConfigHeader = \"com/mycila/maven/plugin/license/templates/GPL-3.txt\";\n    format.project = new MavenProjectStub();\n    format.execute();\n\n    // Let's try to remove it\n    LicenseRemoveMojo remove = new LicenseRemoveMojo();\n    remove.defaultBasedir = tmp;\n    remove.legacyConfigHeader = \"com/mycila/maven/plugin/license/templates/GPL-3.txt\";\n    remove.project = new MavenProjectStub();\n//        remove.keywords = new String[]{\"GNU\"};\n    remove.execute();\n\n    List<String> linesAfterRemove = Files.readLines(destFile, StandardCharsets.UTF_8);\n    org.assertj.core.api.Assertions.assertThat(linesAfterRemove).hasSize(2);\n  }\n}\n",
    "project": "license-maven-plugin",
    "libraryName": "maven-plugin-testing-harness",
    "libraryGroupID": "org.apache.maven.plugin-testing",
    "newVersion": "4.0.0-beta-3",
    "previousVersion": "4.0.0-alpha-2",
    "breakingCommit": "f3c21936175d1aada8ae02617b66d32a748953f4"
}