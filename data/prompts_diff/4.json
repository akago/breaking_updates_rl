{
    "absolute_path_to_file_in_container": "/liquibase-mssql/src/java/liquibase/ext/mssql/sqlgenerator/CreateIndexGeneratorMSSQL.java",
    "errors": [
        {
            "line_number": 12,
            "message": "[ERROR] /liquibase-mssql/src/java/liquibase/ext/mssql/sqlgenerator/CreateIndexGeneratorMSSQL.java:[12,22] cannot find symbol",
            "additional_info": "  symbol:   class StringUtils\n  location: package liquibase.util",
            "file_name": "CreateIndexGeneratorMSSQL.java",
            "BCs": [
                {
                    "element": "liquibase.util.StringUtils",
                    "nature": "DELETION",
                    "kind": "TYPE_REMOVED"
                }
            ],
            "Additions": [
                "++ public final liquibase.repackaged.net.sf.jsqlparser.statement.create.table.Index liquibase.repackaged.net.sf.jsqlparser.parser.CCJSqlParser.Index()",
                "++ public Index liquibase.repackaged.net.sf.jsqlparser.statement.create.table.Index()",
                "++ public StringUtils liquibase.repackaged.org.apache.commons.lang3.StringUtils()",
                "++ public StringUtils liquibase.repackaged.org.apache.commons.lang3.StringUtils()"
            ],
            "uid": "499e8ca7-a3e4-5b6c-b3a3-a915e9d9a871"
        },
        {
            "line_number": 77,
            "message": "[ERROR] /liquibase-mssql/src/java/liquibase/ext/mssql/sqlgenerator/CreateIndexGeneratorMSSQL.java:[77,9] cannot find symbol",
            "additional_info": "  symbol:   variable StringUtils\n  location: class liquibase.ext.mssql.sqlgenerator.CreateIndexGeneratorMSSQL",
            "file_name": "CreateIndexGeneratorMSSQL.java",
            "BCs": [
                {
                    "element": "liquibase.util.StringUtils",
                    "nature": "DELETION",
                    "kind": "TYPE_REMOVED"
                }
            ],
            "Additions": [
                "++ public final liquibase.repackaged.net.sf.jsqlparser.statement.create.table.Index liquibase.repackaged.net.sf.jsqlparser.parser.CCJSqlParser.Index()",
                "++ public Index liquibase.repackaged.net.sf.jsqlparser.statement.create.table.Index()",
                "++ public StringUtils liquibase.repackaged.org.apache.commons.lang3.StringUtils()",
                "++ public StringUtils liquibase.repackaged.org.apache.commons.lang3.StringUtils()"
            ],
            "uid": "fe5c2588-2c28-5539-8f9c-8cb9abfff008"
        }
    ],
    "prompt": "\nThe following Java client code fails: \n'''java\npackage liquibase.ext.mssql.sqlgenerator;\n\nimport liquibase.change.AddColumnConfig;\nimport liquibase.database.Database;\nimport liquibase.ext.mssql.database.MSSQLDatabase;\nimport liquibase.ext.mssql.statement.CreateIndexStatementMSSQL;\nimport liquibase.sql.Sql;\nimport liquibase.sql.UnparsedSql;\nimport liquibase.sqlgenerator.SqlGeneratorChain;\nimport liquibase.sqlgenerator.core.CreateIndexGenerator;\nimport liquibase.statement.core.CreateIndexStatement;\nimport liquibase.util.StringUtils;\n\nimport java.util.Arrays;\nimport java.util.Iterator;\n\npublic class CreateIndexGeneratorMSSQL extends CreateIndexGenerator {\n  @Override\n  public int getPriority() {\n    return 15;\n  }\n\n  @Override\n  public Sql[] generateSql(CreateIndexStatement statement, Database database, SqlGeneratorChain sqlGeneratorChain) {\n    if (statement instanceof CreateIndexStatementMSSQL) {\n      return generateMSSQLSql((CreateIndexStatementMSSQL)statement, database, sqlGeneratorChain);\n    }\n\n    return super.generateSql(statement, database, sqlGeneratorChain);\n  }\n\n  private Sql[] generateMSSQLSql(CreateIndexStatementMSSQL statement, Database database, SqlGeneratorChain sqlGeneratorChain) {\n    StringBuilder builder = new StringBuilder();\n\n    // Basically copied from liquibase.sqlgenerator.core.CreateIndexGenerator\n    builder.append(\"CREATE \");\n    if (statement.isUnique() != null && statement.isUnique()) {\n      builder.append(\"UNIQUE \");\n    }\n    \n    if (statement.isClustered() != null) {\n        if (statement.isClustered()) {\n            builder.append(\"CLUSTERED \");\n        } else {\n            builder.append(\"NONCLUSTERED \");\n        }\n    }\n    \n    builder.append(\"INDEX \");\n\n    if (statement.getIndexName() != null) {\n      String indexSchema = statement.getTableSchemaName();\n      builder.append(database.escapeIndexName(statement.getTableCatalogName(), indexSchema, statement.getIndexName())).append(\" \");\n    }\n    builder.append(\"ON \");\n    builder.append(database.escapeTableName(statement.getTableCatalogName(), statement.getTableSchemaName(), statement.getTableName())).append(\"(\");\n    Iterator<AddColumnConfig> iterator = Arrays.asList(statement.getColumns()).iterator();\n    while (iterator.hasNext()) {\n      AddColumnConfig column = iterator.next();\n      builder.append(database.escapeColumnName(statement.getTableCatalogName(), statement.getTableSchemaName(), statement.getTableName(), column.getName()));\n      if (column.getDescending() != null && column.getDescending()) {\n          builder.append(\" DESC\");\n      }\n      if (iterator.hasNext()) {\n        builder.append(\", \");\n      }\n    }\n    if (statement.getIncludedColumns() != null && ! statement.getIncludedColumns().isEmpty()) {\n      builder.append(\") INCLUDE (\");\n      builder.append(database.escapeColumnNameList(statement.getIncludedColumns()));\n    }\n    builder.append(\")\");\n    if (statement.getFillFactor() != null) {\n      builder.append(\" WITH (FILLFACTOR = \").append(statement.getFillFactor()).append(\")\");\n    }\n    // This block simplified, since we know we have MSSQLDatabase\n    if (StringUtils.trimToNull(statement.getTablespace()) != null) {\n      builder.append(\" ON \").append(statement.getTablespace());\n    }\n\n    return new Sql[]{new UnparsedSql(builder.toString(), getAffectedIndex(statement))};\n  }\n\n  @Override\n  public boolean supports(CreateIndexStatement statement, Database database) {\n    return database instanceof MSSQLDatabase;\n  }\n}\n\n'''\nThe error is caused by a change in the API of the dependency: liquibase-core 3.4.2->4.8.0. \nThe new library version includes the following relevant backward incompatible changes on API. \n(API changes format: lines starting with '--' denote removed members, '++' denote added ones, '~~' denote mutations with change kind) \n-- liquibase.util.StringUtils\n++ METHOD_ABSTRACT_ADDED_TO_CLASS <- liquibase.executor.ExecutorService\n++ METHOD_ADDED_TO_INTERFACE <- liquibase.database.Database\n-- liquibase.servicelocator.ServiceLocator.getInstance\n~~ METHOD_NOW_FINAL <- liquibase.logging.LogFactory.getInstance\n-- liquibase.executor.ExecutorService.getInstance\n++ public final null liquibase.repackaged.net.sf.jsqlparser.schema.Database\n++ public static liquibase.repackaged.org.apache.commons.lang3.time.FastDateFormat liquibase.repackaged.org.apache.commons.lang3.time.FastDateFormat.getInstance(java.lang.String)\n++ public static liquibase.repackaged.org.apache.commons.lang3.time.FastDateFormat liquibase.repackaged.org.apache.commons.lang3.time.FastDateFormat.getInstance(java.lang.String,java.util.TimeZone)\n++ public static transient liquibase.repackaged.org.apache.commons.lang3.CharSet liquibase.repackaged.org.apache.commons.lang3.CharSet.getInstance(java.lang.String[])\n++ public static liquibase.pro.packaged.iI liquibase.pro.packaged.iI.getInstance()\n++ public static synchronized liquibase.database.ConnectionServiceFactory liquibase.database.ConnectionServiceFactory.getInstance()\n++ public static liquibase.pro.packaged.iD liquibase.pro.packaged.iD.getInstance()\n++ public Database liquibase.repackaged.net.sf.jsqlparser.schema.Database(java.lang.String)\n++ public StringUtils liquibase.repackaged.org.apache.commons.lang3.StringUtils()\n++ public static liquibase.repackaged.org.apache.commons.lang3.time.FastDateFormat liquibase.repackaged.org.apache.commons.lang3.time.FastDateFormat.getInstance(java.lang.String,java.util.TimeZone,java.util.Locale)\n++ public Index liquibase.repackaged.net.sf.jsqlparser.statement.create.table.Index()\n++ public static liquibase.repackaged.org.apache.commons.lang3.time.FastDateFormat liquibase.repackaged.org.apache.commons.lang3.time.FastDateFormat.getInstance(java.lang.String,java.util.Locale)\n++ public Database liquibase.repackaged.net.sf.jsqlparser.schema.Database(liquibase.repackaged.net.sf.jsqlparser.schema.Server,java.lang.String)\n++ public static liquibase.pro.packaged.aZ liquibase.pro.packaged.aZ.getInstance()\n++ public static liquibase.command.CommandFactory liquibase.command.CommandFactory.getInstance()\n++ public static liquibase.repackaged.org.apache.commons.lang3.time.FastDateFormat liquibase.repackaged.org.apache.commons.lang3.time.FastDateFormat.getInstance()\n++ public final liquibase.repackaged.net.sf.jsqlparser.statement.create.table.Index liquibase.repackaged.net.sf.jsqlparser.parser.CCJSqlParser.Index()\n\nThe error is triggered in the following specific lines in the previous code:\nimport liquibase.util.StringUtils;\n    if (StringUtils.trimToNull(statement.getTablespace()) != null) {\nwith the following error message:\n[ERROR] /liquibase-mssql/src/java/liquibase/ext/mssql/sqlgenerator/CreateIndexGeneratorMSSQL.java:[12,22] cannot find symbol  symbol:   class StringUtils\n  location: package liquibase.util\n[ERROR] /liquibase-mssql/src/java/liquibase/ext/mssql/sqlgenerator/CreateIndexGeneratorMSSQL.java:[77,9] cannot find symbol  symbol:   variable StringUtils\n  location: class liquibase.ext.mssql.sqlgenerator.CreateIndexGeneratorMSSQL\n\nPlease apply your reasoning and generate the fix following the system instruction.\n",
    "buggy_lines": "import liquibase.util.StringUtils;\n    if (StringUtils.trimToNull(statement.getTablespace()) != null) {",
    "error_message": "[ERROR] /liquibase-mssql/src/java/liquibase/ext/mssql/sqlgenerator/CreateIndexGeneratorMSSQL.java:[12,22] cannot find symbol  symbol:   class StringUtils\n  location: package liquibase.util\n[ERROR] /liquibase-mssql/src/java/liquibase/ext/mssql/sqlgenerator/CreateIndexGeneratorMSSQL.java:[77,9] cannot find symbol  symbol:   variable StringUtils\n  location: class liquibase.ext.mssql.sqlgenerator.CreateIndexGeneratorMSSQL",
    "api_diff": "-- liquibase.util.StringUtils\n++ METHOD_ABSTRACT_ADDED_TO_CLASS <- liquibase.executor.ExecutorService\n++ METHOD_ADDED_TO_INTERFACE <- liquibase.database.Database\n-- liquibase.servicelocator.ServiceLocator.getInstance\n~~ METHOD_NOW_FINAL <- liquibase.logging.LogFactory.getInstance\n-- liquibase.executor.ExecutorService.getInstance\n++ public final null liquibase.repackaged.net.sf.jsqlparser.schema.Database\n++ public static liquibase.repackaged.org.apache.commons.lang3.time.FastDateFormat liquibase.repackaged.org.apache.commons.lang3.time.FastDateFormat.getInstance(java.lang.String)\n++ public static liquibase.repackaged.org.apache.commons.lang3.time.FastDateFormat liquibase.repackaged.org.apache.commons.lang3.time.FastDateFormat.getInstance(java.lang.String,java.util.TimeZone)\n++ public static transient liquibase.repackaged.org.apache.commons.lang3.CharSet liquibase.repackaged.org.apache.commons.lang3.CharSet.getInstance(java.lang.String[])\n++ public static liquibase.pro.packaged.iI liquibase.pro.packaged.iI.getInstance()\n++ public static synchronized liquibase.database.ConnectionServiceFactory liquibase.database.ConnectionServiceFactory.getInstance()\n++ public static liquibase.pro.packaged.iD liquibase.pro.packaged.iD.getInstance()\n++ public Database liquibase.repackaged.net.sf.jsqlparser.schema.Database(java.lang.String)\n++ public StringUtils liquibase.repackaged.org.apache.commons.lang3.StringUtils()\n++ public static liquibase.repackaged.org.apache.commons.lang3.time.FastDateFormat liquibase.repackaged.org.apache.commons.lang3.time.FastDateFormat.getInstance(java.lang.String,java.util.TimeZone,java.util.Locale)\n++ public Index liquibase.repackaged.net.sf.jsqlparser.statement.create.table.Index()\n++ public static liquibase.repackaged.org.apache.commons.lang3.time.FastDateFormat liquibase.repackaged.org.apache.commons.lang3.time.FastDateFormat.getInstance(java.lang.String,java.util.Locale)\n++ public Database liquibase.repackaged.net.sf.jsqlparser.schema.Database(liquibase.repackaged.net.sf.jsqlparser.schema.Server,java.lang.String)\n++ public static liquibase.pro.packaged.aZ liquibase.pro.packaged.aZ.getInstance()\n++ public static liquibase.command.CommandFactory liquibase.command.CommandFactory.getInstance()\n++ public static liquibase.repackaged.org.apache.commons.lang3.time.FastDateFormat liquibase.repackaged.org.apache.commons.lang3.time.FastDateFormat.getInstance()\n++ public final liquibase.repackaged.net.sf.jsqlparser.statement.create.table.Index liquibase.repackaged.net.sf.jsqlparser.parser.CCJSqlParser.Index()",
    "original_code": "package liquibase.ext.mssql.sqlgenerator;\n\nimport liquibase.change.AddColumnConfig;\nimport liquibase.database.Database;\nimport liquibase.ext.mssql.database.MSSQLDatabase;\nimport liquibase.ext.mssql.statement.CreateIndexStatementMSSQL;\nimport liquibase.sql.Sql;\nimport liquibase.sql.UnparsedSql;\nimport liquibase.sqlgenerator.SqlGeneratorChain;\nimport liquibase.sqlgenerator.core.CreateIndexGenerator;\nimport liquibase.statement.core.CreateIndexStatement;\nimport liquibase.util.StringUtils;\n\nimport java.util.Arrays;\nimport java.util.Iterator;\n\npublic class CreateIndexGeneratorMSSQL extends CreateIndexGenerator {\n  @Override\n  public int getPriority() {\n    return 15;\n  }\n\n  @Override\n  public Sql[] generateSql(CreateIndexStatement statement, Database database, SqlGeneratorChain sqlGeneratorChain) {\n    if (statement instanceof CreateIndexStatementMSSQL) {\n      return generateMSSQLSql((CreateIndexStatementMSSQL)statement, database, sqlGeneratorChain);\n    }\n\n    return super.generateSql(statement, database, sqlGeneratorChain);\n  }\n\n  private Sql[] generateMSSQLSql(CreateIndexStatementMSSQL statement, Database database, SqlGeneratorChain sqlGeneratorChain) {\n    StringBuilder builder = new StringBuilder();\n\n    // Basically copied from liquibase.sqlgenerator.core.CreateIndexGenerator\n    builder.append(\"CREATE \");\n    if (statement.isUnique() != null && statement.isUnique()) {\n      builder.append(\"UNIQUE \");\n    }\n    \n    if (statement.isClustered() != null) {\n        if (statement.isClustered()) {\n            builder.append(\"CLUSTERED \");\n        } else {\n            builder.append(\"NONCLUSTERED \");\n        }\n    }\n    \n    builder.append(\"INDEX \");\n\n    if (statement.getIndexName() != null) {\n      String indexSchema = statement.getTableSchemaName();\n      builder.append(database.escapeIndexName(statement.getTableCatalogName(), indexSchema, statement.getIndexName())).append(\" \");\n    }\n    builder.append(\"ON \");\n    builder.append(database.escapeTableName(statement.getTableCatalogName(), statement.getTableSchemaName(), statement.getTableName())).append(\"(\");\n    Iterator<AddColumnConfig> iterator = Arrays.asList(statement.getColumns()).iterator();\n    while (iterator.hasNext()) {\n      AddColumnConfig column = iterator.next();\n      builder.append(database.escapeColumnName(statement.getTableCatalogName(), statement.getTableSchemaName(), statement.getTableName(), column.getName()));\n      if (column.getDescending() != null && column.getDescending()) {\n          builder.append(\" DESC\");\n      }\n      if (iterator.hasNext()) {\n        builder.append(\", \");\n      }\n    }\n    if (statement.getIncludedColumns() != null && ! statement.getIncludedColumns().isEmpty()) {\n      builder.append(\") INCLUDE (\");\n      builder.append(database.escapeColumnNameList(statement.getIncludedColumns()));\n    }\n    builder.append(\")\");\n    if (statement.getFillFactor() != null) {\n      builder.append(\" WITH (FILLFACTOR = \").append(statement.getFillFactor()).append(\")\");\n    }\n    // This block simplified, since we know we have MSSQLDatabase\n    if (StringUtils.trimToNull(statement.getTablespace()) != null) {\n      builder.append(\" ON \").append(statement.getTablespace());\n    }\n\n    return new Sql[]{new UnparsedSql(builder.toString(), getAffectedIndex(statement))};\n  }\n\n  @Override\n  public boolean supports(CreateIndexStatement statement, Database database) {\n    return database instanceof MSSQLDatabase;\n  }\n}\n",
    "project": "liquibase-mssql",
    "libraryName": "liquibase-core",
    "libraryGroupID": "org.liquibase",
    "newVersion": "4.8.0",
    "previousVersion": "3.4.2",
    "breakingCommit": "feb582661e77de66eadaa7550720a8751b266ee4"
}