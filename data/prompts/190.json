{
    "absolute_path_to_file_in_container": "/simplelocalize-cli/src/main/java/io/simplelocalize/cli/client/SimpleLocalizeClient.java",
    "errors": [
        {
            "line_number": 88,
            "message": "[ERROR] /simplelocalize-cli/src/main/java/io/simplelocalize/cli/client/SimpleLocalizeClient.java:[88,49] cannot access com.fasterxml.jackson.core.exc.StreamReadException",
            "additional_info": "  class file for com.fasterxml.jackson.core.exc.StreamReadException not found",
            "file_name": "SimpleLocalizeClient.java",
            "BCs": [],
            "Additions": [],
            "uid": "81b7de82-3b5d-5eb4-af94-da2b3a80a3c6"
        }
    ],
    "prompt": "\nThe following Java client code fails: \n'''java\npackage io.simplelocalize.cli.client;\n\nimport com.fasterxml.jackson.databind.ObjectMapper;\nimport com.jayway.jsonpath.JsonPath;\nimport com.jayway.jsonpath.Option;\nimport io.simplelocalize.cli.client.dto.DownloadRequest;\nimport io.simplelocalize.cli.client.dto.DownloadableFile;\nimport io.simplelocalize.cli.client.dto.ExportResponse;\nimport io.simplelocalize.cli.client.dto.UploadRequest;\nimport io.simplelocalize.cli.exception.ApiRequestException;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\nimport java.io.IOException;\nimport java.net.URI;\nimport java.net.http.HttpClient;\nimport java.net.http.HttpRequest;\nimport java.net.http.HttpResponse;\nimport java.nio.file.Files;\nimport java.nio.file.Path;\nimport java.nio.file.StandardOpenOption;\nimport java.time.Duration;\nimport java.util.Collection;\nimport java.util.List;\nimport java.util.Objects;\nimport java.util.Optional;\n\nimport static io.simplelocalize.cli.TemplateKeys.LANGUAGE_TEMPLATE_KEY;\nimport static io.simplelocalize.cli.TemplateKeys.NAMESPACE_TEMPLATE_KEY;\n\npublic class SimpleLocalizeClient\n{\n\n  private static final String ERROR_MESSAGE_PATH = \"$.msg\";\n  private final HttpClient httpClient;\n  private final SimpleLocalizeHttpRequestFactory httpRequestFactory;\n  private final SimpleLocalizeUriFactory uriFactory;\n\n  private final Logger log = LoggerFactory.getLogger(SimpleLocalizeClient.class);\n  private final ObjectMapper objectMapper;\n\n  public SimpleLocalizeClient(String baseUrl, String apiKey)\n  {\n\n    Objects.requireNonNull(baseUrl);\n    Objects.requireNonNull(apiKey);\n    this.uriFactory = new SimpleLocalizeUriFactory(baseUrl);\n    this.httpRequestFactory = new SimpleLocalizeHttpRequestFactory(apiKey);\n    this.objectMapper = new ObjectMapper();\n    this.httpClient = HttpClient.newBuilder()\n            .connectTimeout(Duration.ofMinutes(5))\n            .build();\n  }\n\n  public static SimpleLocalizeClient create(String baseUrl, String apiKey)\n  {\n    return new SimpleLocalizeClient(baseUrl, apiKey);\n  }\n\n  public void uploadKeys(Collection<String> keys) throws IOException, InterruptedException\n  {\n    URI uri = uriFactory.buildSendKeysURI();\n    HttpRequest httpRequest = httpRequestFactory.createSendKeysRequest(uri, keys);\n    HttpResponse<String> httpResponse = httpClient.send(httpRequest, HttpResponse.BodyHandlers.ofString());\n    throwOnError(httpResponse);\n    int keysProcessed = JsonPath.read(httpResponse.body(), \"$.data.uniqueKeysProcessed\");\n    log.info(\"Successfully uploaded {} keys\", keysProcessed);\n  }\n\n  public void uploadFile(UploadRequest uploadRequest) throws IOException, InterruptedException\n  {\n    Path uploadPath = uploadRequest.getPath();\n    log.info(\"Uploading {}\", uploadPath);\n    URI uri = uriFactory.buildUploadUri(uploadRequest);\n    HttpRequest httpRequest = httpRequestFactory.createUploadFileRequest(uri, uploadRequest);\n    HttpResponse<String> httpResponse = httpClient.send(httpRequest, HttpResponse.BodyHandlers.ofString());\n    throwOnError(httpResponse);\n  }\n\n  public List<DownloadableFile> fetchDownloadableFiles(DownloadRequest downloadRequest) throws IOException, InterruptedException\n  {\n    log.info(\"Preparing files to download\");\n    URI downloadUri = uriFactory.buildDownloadUri(downloadRequest);\n    HttpRequest httpRequest = httpRequestFactory.createGetRequest(downloadUri).build();\n    HttpResponse<String> httpResponse = httpClient.send(httpRequest, HttpResponse.BodyHandlers.ofString());\n    throwOnError(httpResponse);\n    String body = httpResponse.body();\n    ExportResponse exportResponse = objectMapper.readValue(body, ExportResponse.class);\n    return exportResponse.getFiles();\n  }\n\n  public void downloadFile(DownloadableFile downloadableFile, String downloadPathTemplate)\n  {\n    Optional<DownloadableFile> optionalDownloadableFile = Optional.of(downloadableFile);\n    String downloadPath = downloadPathTemplate\n            .replace(NAMESPACE_TEMPLATE_KEY, optionalDownloadableFile.map(DownloadableFile::getNamespace).orElse(\"\"))\n            .replace(LANGUAGE_TEMPLATE_KEY, optionalDownloadableFile.map(DownloadableFile::getLanguage).orElse(\"\"));\n    String url = downloadableFile.getUrl();\n    HttpRequest httpRequest = httpRequestFactory.createGetRequest(URI.create(url)).build();\n    Path savePath = Path.of(downloadPath);\n    try\n    {\n      Path parentDirectory = savePath.getParent();\n      if (parentDirectory != null)\n      {\n        Files.createDirectories(parentDirectory);\n      }\n      log.info(\"Downloading {}\", savePath);\n      httpClient.send(httpRequest, HttpResponse.BodyHandlers.ofFile(savePath, StandardOpenOption.CREATE, StandardOpenOption.WRITE, StandardOpenOption.TRUNCATE_EXISTING));\n    } catch (IOException e)\n    {\n      log.error(\"Download failed: {}\", savePath, e);\n    } catch (InterruptedException e)\n    {\n      log.error(\"Download interrupted: {}\", savePath, e);\n      Thread.currentThread().interrupt();\n    }\n  }\n\n  public int validateGate() throws IOException, InterruptedException\n  {\n    URI validateUri = uriFactory.buildValidateGateUri();\n    HttpRequest httpRequest = httpRequestFactory.createGetRequest(validateUri).build();\n    HttpResponse<String> httpResponse = httpClient.send(httpRequest, HttpResponse.BodyHandlers.ofString());\n    throwOnError(httpResponse);\n    String json = httpResponse.body();\n    Boolean passed = JsonPath.read(json, \"$.data.passed\");\n    String message = JsonPath.read(json, \"$.data.message\");\n    int status = JsonPath.read(json, \"$.data.status\");\n    log.info(\"Gate result: {} (status: {}, message: {})\", passed, status, message);\n    return status;\n  }\n\n  private void throwOnError(HttpResponse<?> httpResponse)\n  {\n    if (httpResponse.statusCode() != 200)\n    {\n      com.jayway.jsonpath.Configuration parseContext = com.jayway.jsonpath.Configuration\n              .defaultConfiguration()\n              .addOptions(Option.SUPPRESS_EXCEPTIONS);\n\n      Object responseBody = httpResponse.body();\n      String stringBody = safeCastHttpBodyToString(responseBody);\n      String message = JsonPath.using(parseContext).parse(stringBody).read(ERROR_MESSAGE_PATH);\n      if (message == null)\n      {\n        message = \"Unknown error, HTTP Status: \" + httpResponse.statusCode();\n      }\n      log.error(\"Request failed: {}\", message);\n      throw new ApiRequestException(message, httpResponse);\n    }\n  }\n\n  private String safeCastHttpBodyToString(Object responseBody)\n  {\n    if (responseBody instanceof byte[])\n    {\n      return new String((byte[]) responseBody);\n    } else if (responseBody instanceof String)\n    {\n      return (String) responseBody;\n    }\n    return \"\";\n  }\n\n\n}\n\n'''\nThe error is caused by a change in the API of the dependency: jackson-databind 2.9.10.5->2.13.4.1. \nThe new library version includes the following relevant backward incompatible changes on API. \n(API changes format: lines starting with '--' denote removed members, '++' denote added ones, '~~' denote mutations with change kind) \n\n\nThe error is triggered in the following specific lines in the previous code:\n    ExportResponse exportResponse = objectMapper.readValue(body, ExportResponse.class);\nwith the following error message:\n[ERROR] /simplelocalize-cli/src/main/java/io/simplelocalize/cli/client/SimpleLocalizeClient.java:[88,49] cannot access com.fasterxml.jackson.core.exc.StreamReadException  class file for com.fasterxml.jackson.core.exc.StreamReadException not found\n\nPlease apply your reasoning and generate the fix following the system instruction.\n",
    "buggy_lines": "    ExportResponse exportResponse = objectMapper.readValue(body, ExportResponse.class);",
    "error_message": "[ERROR] /simplelocalize-cli/src/main/java/io/simplelocalize/cli/client/SimpleLocalizeClient.java:[88,49] cannot access com.fasterxml.jackson.core.exc.StreamReadException  class file for com.fasterxml.jackson.core.exc.StreamReadException not found",
    "api_diff": "",
    "original_code": "package io.simplelocalize.cli.client;\n\nimport com.fasterxml.jackson.databind.ObjectMapper;\nimport com.jayway.jsonpath.JsonPath;\nimport com.jayway.jsonpath.Option;\nimport io.simplelocalize.cli.client.dto.DownloadRequest;\nimport io.simplelocalize.cli.client.dto.DownloadableFile;\nimport io.simplelocalize.cli.client.dto.ExportResponse;\nimport io.simplelocalize.cli.client.dto.UploadRequest;\nimport io.simplelocalize.cli.exception.ApiRequestException;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\nimport java.io.IOException;\nimport java.net.URI;\nimport java.net.http.HttpClient;\nimport java.net.http.HttpRequest;\nimport java.net.http.HttpResponse;\nimport java.nio.file.Files;\nimport java.nio.file.Path;\nimport java.nio.file.StandardOpenOption;\nimport java.time.Duration;\nimport java.util.Collection;\nimport java.util.List;\nimport java.util.Objects;\nimport java.util.Optional;\n\nimport static io.simplelocalize.cli.TemplateKeys.LANGUAGE_TEMPLATE_KEY;\nimport static io.simplelocalize.cli.TemplateKeys.NAMESPACE_TEMPLATE_KEY;\n\npublic class SimpleLocalizeClient\n{\n\n  private static final String ERROR_MESSAGE_PATH = \"$.msg\";\n  private final HttpClient httpClient;\n  private final SimpleLocalizeHttpRequestFactory httpRequestFactory;\n  private final SimpleLocalizeUriFactory uriFactory;\n\n  private final Logger log = LoggerFactory.getLogger(SimpleLocalizeClient.class);\n  private final ObjectMapper objectMapper;\n\n  public SimpleLocalizeClient(String baseUrl, String apiKey)\n  {\n\n    Objects.requireNonNull(baseUrl);\n    Objects.requireNonNull(apiKey);\n    this.uriFactory = new SimpleLocalizeUriFactory(baseUrl);\n    this.httpRequestFactory = new SimpleLocalizeHttpRequestFactory(apiKey);\n    this.objectMapper = new ObjectMapper();\n    this.httpClient = HttpClient.newBuilder()\n            .connectTimeout(Duration.ofMinutes(5))\n            .build();\n  }\n\n  public static SimpleLocalizeClient create(String baseUrl, String apiKey)\n  {\n    return new SimpleLocalizeClient(baseUrl, apiKey);\n  }\n\n  public void uploadKeys(Collection<String> keys) throws IOException, InterruptedException\n  {\n    URI uri = uriFactory.buildSendKeysURI();\n    HttpRequest httpRequest = httpRequestFactory.createSendKeysRequest(uri, keys);\n    HttpResponse<String> httpResponse = httpClient.send(httpRequest, HttpResponse.BodyHandlers.ofString());\n    throwOnError(httpResponse);\n    int keysProcessed = JsonPath.read(httpResponse.body(), \"$.data.uniqueKeysProcessed\");\n    log.info(\"Successfully uploaded {} keys\", keysProcessed);\n  }\n\n  public void uploadFile(UploadRequest uploadRequest) throws IOException, InterruptedException\n  {\n    Path uploadPath = uploadRequest.getPath();\n    log.info(\"Uploading {}\", uploadPath);\n    URI uri = uriFactory.buildUploadUri(uploadRequest);\n    HttpRequest httpRequest = httpRequestFactory.createUploadFileRequest(uri, uploadRequest);\n    HttpResponse<String> httpResponse = httpClient.send(httpRequest, HttpResponse.BodyHandlers.ofString());\n    throwOnError(httpResponse);\n  }\n\n  public List<DownloadableFile> fetchDownloadableFiles(DownloadRequest downloadRequest) throws IOException, InterruptedException\n  {\n    log.info(\"Preparing files to download\");\n    URI downloadUri = uriFactory.buildDownloadUri(downloadRequest);\n    HttpRequest httpRequest = httpRequestFactory.createGetRequest(downloadUri).build();\n    HttpResponse<String> httpResponse = httpClient.send(httpRequest, HttpResponse.BodyHandlers.ofString());\n    throwOnError(httpResponse);\n    String body = httpResponse.body();\n    ExportResponse exportResponse = objectMapper.readValue(body, ExportResponse.class);\n    return exportResponse.getFiles();\n  }\n\n  public void downloadFile(DownloadableFile downloadableFile, String downloadPathTemplate)\n  {\n    Optional<DownloadableFile> optionalDownloadableFile = Optional.of(downloadableFile);\n    String downloadPath = downloadPathTemplate\n            .replace(NAMESPACE_TEMPLATE_KEY, optionalDownloadableFile.map(DownloadableFile::getNamespace).orElse(\"\"))\n            .replace(LANGUAGE_TEMPLATE_KEY, optionalDownloadableFile.map(DownloadableFile::getLanguage).orElse(\"\"));\n    String url = downloadableFile.getUrl();\n    HttpRequest httpRequest = httpRequestFactory.createGetRequest(URI.create(url)).build();\n    Path savePath = Path.of(downloadPath);\n    try\n    {\n      Path parentDirectory = savePath.getParent();\n      if (parentDirectory != null)\n      {\n        Files.createDirectories(parentDirectory);\n      }\n      log.info(\"Downloading {}\", savePath);\n      httpClient.send(httpRequest, HttpResponse.BodyHandlers.ofFile(savePath, StandardOpenOption.CREATE, StandardOpenOption.WRITE, StandardOpenOption.TRUNCATE_EXISTING));\n    } catch (IOException e)\n    {\n      log.error(\"Download failed: {}\", savePath, e);\n    } catch (InterruptedException e)\n    {\n      log.error(\"Download interrupted: {}\", savePath, e);\n      Thread.currentThread().interrupt();\n    }\n  }\n\n  public int validateGate() throws IOException, InterruptedException\n  {\n    URI validateUri = uriFactory.buildValidateGateUri();\n    HttpRequest httpRequest = httpRequestFactory.createGetRequest(validateUri).build();\n    HttpResponse<String> httpResponse = httpClient.send(httpRequest, HttpResponse.BodyHandlers.ofString());\n    throwOnError(httpResponse);\n    String json = httpResponse.body();\n    Boolean passed = JsonPath.read(json, \"$.data.passed\");\n    String message = JsonPath.read(json, \"$.data.message\");\n    int status = JsonPath.read(json, \"$.data.status\");\n    log.info(\"Gate result: {} (status: {}, message: {})\", passed, status, message);\n    return status;\n  }\n\n  private void throwOnError(HttpResponse<?> httpResponse)\n  {\n    if (httpResponse.statusCode() != 200)\n    {\n      com.jayway.jsonpath.Configuration parseContext = com.jayway.jsonpath.Configuration\n              .defaultConfiguration()\n              .addOptions(Option.SUPPRESS_EXCEPTIONS);\n\n      Object responseBody = httpResponse.body();\n      String stringBody = safeCastHttpBodyToString(responseBody);\n      String message = JsonPath.using(parseContext).parse(stringBody).read(ERROR_MESSAGE_PATH);\n      if (message == null)\n      {\n        message = \"Unknown error, HTTP Status: \" + httpResponse.statusCode();\n      }\n      log.error(\"Request failed: {}\", message);\n      throw new ApiRequestException(message, httpResponse);\n    }\n  }\n\n  private String safeCastHttpBodyToString(Object responseBody)\n  {\n    if (responseBody instanceof byte[])\n    {\n      return new String((byte[]) responseBody);\n    } else if (responseBody instanceof String)\n    {\n      return (String) responseBody;\n    }\n    return \"\";\n  }\n\n\n}\n",
    "project": "simplelocalize-cli",
    "libraryName": "jackson-databind",
    "libraryGroupID": "com.fasterxml.jackson.core",
    "newVersion": "2.13.4.1",
    "previousVersion": "2.9.10.5",
    "breakingCommit": "741f3b5e20a91b0e9305ae79261e3c5e64971c98"
}