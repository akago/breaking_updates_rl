{
    "absolute_path_to_file_in_container": "/geostore/src/core/security/src/main/java/it/geosolutions/geostore/core/security/password/GeoStoreDigestPasswordEncoder.java",
    "errors": [
        {
            "line_number": 24,
            "message": "[ERROR] /geostore/src/core/security/src/main/java/it/geosolutions/geostore/core/security/password/GeoStoreDigestPasswordEncoder.java:[24,33] error: package org.jasypt.spring.security does not exist",
            "additional_info": "",
            "file_name": "GeoStoreDigestPasswordEncoder.java",
            "BCs": [
                {
                    "element": "org.jasypt.spring.security2.PasswordEncoder",
                    "nature": "DELETION",
                    "kind": "TYPE_REMOVED"
                },
                {
                    "element": "org.jasypt.spring.security.PasswordEncoder",
                    "nature": "DELETION",
                    "kind": "TYPE_REMOVED"
                },
                {
                    "element": "org.jasypt.spring.security3.PasswordEncoder",
                    "nature": "DELETION",
                    "kind": "TYPE_REMOVED"
                }
            ],
            "Additions": [],
            "uid": "a90bd157-111e-5c21-99ef-1ecbe77a654b"
        },
        {
            "line_number": 44,
            "message": "[ERROR] /geostore/src/core/security/src/main/java/it/geosolutions/geostore/core/security/password/GeoStoreDigestPasswordEncoder.java:[44,15] error: cannot find symbol",
            "additional_info": "[ERROR]   symbol:   class PasswordEncoder\n  location: class GeoStoreDigestPasswordEncoder",
            "file_name": "GeoStoreDigestPasswordEncoder.java",
            "BCs": [
                {
                    "element": "org.jasypt.spring.security2.PasswordEncoder",
                    "nature": "DELETION",
                    "kind": "TYPE_REMOVED"
                },
                {
                    "element": "org.jasypt.spring.security.PasswordEncoder",
                    "nature": "DELETION",
                    "kind": "TYPE_REMOVED"
                },
                {
                    "element": "org.jasypt.spring.security3.PasswordEncoder",
                    "nature": "DELETION",
                    "kind": "TYPE_REMOVED"
                }
            ],
            "Additions": [],
            "uid": "6756d3cd-d423-5bd9-8f12-fbc3eb4c3abb"
        },
        {
            "line_number": 45,
            "message": "[ERROR] /geostore/src/core/security/src/main/java/it/geosolutions/geostore/core/security/password/GeoStoreDigestPasswordEncoder.java:[45,9] error: cannot find symbol",
            "additional_info": "[ERROR]   symbol:   class PasswordEncoder\n[ERROR]   location: class GeoStoreDigestPasswordEncoder",
            "file_name": "GeoStoreDigestPasswordEncoder.java",
            "BCs": [
                {
                    "element": "org.jasypt.spring.security2.PasswordEncoder",
                    "nature": "DELETION",
                    "kind": "TYPE_REMOVED"
                },
                {
                    "element": "org.jasypt.spring.security.PasswordEncoder",
                    "nature": "DELETION",
                    "kind": "TYPE_REMOVED"
                },
                {
                    "element": "org.jasypt.spring.security3.PasswordEncoder",
                    "nature": "DELETION",
                    "kind": "TYPE_REMOVED"
                }
            ],
            "Additions": [],
            "uid": "234e0d2c-9e91-5f9d-bf6e-337892ea515a"
        }
    ],
    "prompt": "\nThe following Java client code fails: \n'''java\n/*\n *  Copyright (C) 2007 - 2011 GeoSolutions S.A.S.\n *  http://www.geo-solutions.it\n * \n *  GPLv3 + Classpath exception\n * \n *  This program is free software: you can redistribute it and/or modify\n *  it under the terms of the GNU General Public License as published by\n *  the Free Software Foundation, either version 3 of the License, or\n *  (at your option) any later version.\n * \n *  This program is distributed in the hope that it will be useful,\n *  but WITHOUT ANY WARRANTY; without even the implied warranty of\n *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *  GNU General Public License for more details.\n * \n *  You should have received a copy of the GNU General Public License\n *  along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\npackage it.geosolutions.geostore.core.security.password;\n\nimport org.apache.commons.codec.binary.Base64;\nimport org.jasypt.digest.StandardByteDigester;\nimport org.jasypt.spring.security.PasswordEncoder;\nimport org.jasypt.util.password.StrongPasswordEncryptor;\nimport static it.geosolutions.geostore.core.security.password.SecurityUtils.toBytes;\n\n/**\n * This Encoder provide encription and check of password using a digest\n * @author Lorenzo Natali (lorenzo.natali at geo-solutions.it)\n *\n */\npublic class GeoStoreDigestPasswordEncoder extends AbstractGeoStorePasswordEncoder{\n\t\n\n\t\t/**\n\t\t * The digest is not reversible\n\t\t */\n\t    public GeoStoreDigestPasswordEncoder() {\n\t        setReversible(false);\n\t    }\n\n\t    @Override\n\t    protected PasswordEncoder createStringEncoder() {\n\t        PasswordEncoder encoder = new PasswordEncoder();\n\t        encoder.setPasswordEncryptor(new StrongPasswordEncryptor());\n\t        return encoder;\n\t    }\n\n\t    @Override\n\t    protected CharArrayPasswordEncoder createCharEncoder() {\n\t        return new CharArrayPasswordEncoder() {\n\t            StandardByteDigester digester = new StandardByteDigester();\n\t            {\n\t                digester.setAlgorithm(\"SHA-256\");\n\t                digester.setIterations(100000);\n\t                digester.setSaltSizeBytes(16);\n\t                digester.initialize();\n\t            }\n\t            \n\t            @Override\n\t            public String encodePassword(char[] rawPass, Object salt) {\n\t                return new String(Base64.encodeBase64(digester.digest(toBytes(rawPass))));\n\t            }\n\t            @Override\n\t            public boolean isPasswordValid(String encPass, char[] rawPass, Object salt) {\n\t                return digester.matches(toBytes(rawPass), Base64.decodeBase64(encPass.getBytes())); \n\t            }\n\t        };\n\t    }\n\n\t    @Override\n\t    public PasswordEncodingType getEncodingType() {\n\t        return PasswordEncodingType.DIGEST;\n\t    }\n\t\n}\n\n'''\nThe error is caused by a change in the API of the dependency: jasypt 1.8->1.9.2. \nThe new library version includes the following relevant backward incompatible changes on API. \n(API changes format: lines starting with '--' denote removed members, '++' denote added ones, '~~' denote mutations with change kind) \n-- org.jasypt.spring.security2.PBEPasswordEncoder\n-- org.jasypt.spring.security2.PasswordEncoder\n-- org.jasypt.spring.security.PasswordEncoder\n-- org.jasypt.spring.security.PBEPasswordEncoder\n-- org.jasypt.spring.security3.PBEPasswordEncoder\n-- org.jasypt.spring.security3.PasswordEncoder\n\nThe error is triggered in the following specific lines in the previous code:\nimport org.jasypt.spring.security.PasswordEncoder;\n\t    protected PasswordEncoder createStringEncoder() {\n\t        PasswordEncoder encoder = new PasswordEncoder();\nwith the following error message:\n[ERROR] /geostore/src/core/security/src/main/java/it/geosolutions/geostore/core/security/password/GeoStoreDigestPasswordEncoder.java:[24,33] error: package org.jasypt.spring.security does not exist\n[ERROR] /geostore/src/core/security/src/main/java/it/geosolutions/geostore/core/security/password/GeoStoreDigestPasswordEncoder.java:[44,15] error: cannot find symbol[ERROR]   symbol:   class PasswordEncoder\n  location: class GeoStoreDigestPasswordEncoder\n[ERROR] /geostore/src/core/security/src/main/java/it/geosolutions/geostore/core/security/password/GeoStoreDigestPasswordEncoder.java:[45,9] error: cannot find symbol[ERROR]   symbol:   class PasswordEncoder\n[ERROR]   location: class GeoStoreDigestPasswordEncoder\n\nPlease apply your reasoning and generate the fix following the system instruction.\n",
    "buggy_lines": "import org.jasypt.spring.security.PasswordEncoder;\n\t    protected PasswordEncoder createStringEncoder() {\n\t        PasswordEncoder encoder = new PasswordEncoder();",
    "error_message": "[ERROR] /geostore/src/core/security/src/main/java/it/geosolutions/geostore/core/security/password/GeoStoreDigestPasswordEncoder.java:[24,33] error: package org.jasypt.spring.security does not exist\n[ERROR] /geostore/src/core/security/src/main/java/it/geosolutions/geostore/core/security/password/GeoStoreDigestPasswordEncoder.java:[44,15] error: cannot find symbol[ERROR]   symbol:   class PasswordEncoder\n  location: class GeoStoreDigestPasswordEncoder\n[ERROR] /geostore/src/core/security/src/main/java/it/geosolutions/geostore/core/security/password/GeoStoreDigestPasswordEncoder.java:[45,9] error: cannot find symbol[ERROR]   symbol:   class PasswordEncoder\n[ERROR]   location: class GeoStoreDigestPasswordEncoder",
    "api_diff": "-- org.jasypt.spring.security2.PBEPasswordEncoder\n-- org.jasypt.spring.security2.PasswordEncoder\n-- org.jasypt.spring.security.PasswordEncoder\n-- org.jasypt.spring.security.PBEPasswordEncoder\n-- org.jasypt.spring.security3.PBEPasswordEncoder\n-- org.jasypt.spring.security3.PasswordEncoder",
    "original_code": "/*\n *  Copyright (C) 2007 - 2011 GeoSolutions S.A.S.\n *  http://www.geo-solutions.it\n * \n *  GPLv3 + Classpath exception\n * \n *  This program is free software: you can redistribute it and/or modify\n *  it under the terms of the GNU General Public License as published by\n *  the Free Software Foundation, either version 3 of the License, or\n *  (at your option) any later version.\n * \n *  This program is distributed in the hope that it will be useful,\n *  but WITHOUT ANY WARRANTY; without even the implied warranty of\n *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *  GNU General Public License for more details.\n * \n *  You should have received a copy of the GNU General Public License\n *  along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\npackage it.geosolutions.geostore.core.security.password;\n\nimport org.apache.commons.codec.binary.Base64;\nimport org.jasypt.digest.StandardByteDigester;\nimport org.jasypt.spring.security.PasswordEncoder;\nimport org.jasypt.util.password.StrongPasswordEncryptor;\nimport static it.geosolutions.geostore.core.security.password.SecurityUtils.toBytes;\n\n/**\n * This Encoder provide encription and check of password using a digest\n * @author Lorenzo Natali (lorenzo.natali at geo-solutions.it)\n *\n */\npublic class GeoStoreDigestPasswordEncoder extends AbstractGeoStorePasswordEncoder{\n\t\n\n\t\t/**\n\t\t * The digest is not reversible\n\t\t */\n\t    public GeoStoreDigestPasswordEncoder() {\n\t        setReversible(false);\n\t    }\n\n\t    @Override\n\t    protected PasswordEncoder createStringEncoder() {\n\t        PasswordEncoder encoder = new PasswordEncoder();\n\t        encoder.setPasswordEncryptor(new StrongPasswordEncryptor());\n\t        return encoder;\n\t    }\n\n\t    @Override\n\t    protected CharArrayPasswordEncoder createCharEncoder() {\n\t        return new CharArrayPasswordEncoder() {\n\t            StandardByteDigester digester = new StandardByteDigester();\n\t            {\n\t                digester.setAlgorithm(\"SHA-256\");\n\t                digester.setIterations(100000);\n\t                digester.setSaltSizeBytes(16);\n\t                digester.initialize();\n\t            }\n\t            \n\t            @Override\n\t            public String encodePassword(char[] rawPass, Object salt) {\n\t                return new String(Base64.encodeBase64(digester.digest(toBytes(rawPass))));\n\t            }\n\t            @Override\n\t            public boolean isPasswordValid(String encPass, char[] rawPass, Object salt) {\n\t                return digester.matches(toBytes(rawPass), Base64.decodeBase64(encPass.getBytes())); \n\t            }\n\t        };\n\t    }\n\n\t    @Override\n\t    public PasswordEncodingType getEncodingType() {\n\t        return PasswordEncodingType.DIGEST;\n\t    }\n\t\n}\n",
    "project": "geostore",
    "libraryName": "jasypt",
    "libraryGroupID": "org.jasypt",
    "newVersion": "1.9.2",
    "previousVersion": "1.8",
    "breakingCommit": "9a8b6fc7847a0782ae4c48d0e4f7056507c0397d"
}