{
    "absolute_path_to_file_in_container": "/docker-adapter/src/test/java/com/artipie/docker/http/AuthScopeSliceTest.java",
    "errors": [
        {
            "line_number": 56,
            "message": "[ERROR] /docker-adapter/src/test/java/com/artipie/docker/http/AuthScopeSliceTest.java:[56,51] cannot find symbol",
            "additional_info": "  symbol:   class User\n  location: interface com.artipie.http.auth.Authentication",
            "file_name": "AuthScopeSliceTest.java",
            "BCs": [],
            "Additions": [],
            "uid": "1d11fac6-1e4d-5953-a8dc-9e031b24ac08"
        },
        {
            "line_number": 57,
            "message": "[ERROR] /docker-adapter/src/test/java/com/artipie/docker/http/AuthScopeSliceTest.java:[57,62] cannot find symbol",
            "additional_info": "  symbol:   class User\n  location: interface com.artipie.http.auth.Authentication",
            "file_name": "AuthScopeSliceTest.java",
            "BCs": [],
            "Additions": [],
            "uid": "1d11fac6-1e4d-5953-a8dc-9e031b24ac08"
        }
    ],
    "prompt": "\nThe following Java client code fails: \n'''java\n/*\n * The MIT License (MIT) Copyright (c) 2020-2023 artipie.com\n * https://github.com/artipie/docker-adapter/LICENSE.txt\n */\npackage com.artipie.docker.http;\n\nimport com.artipie.asto.Content;\nimport com.artipie.http.Headers;\nimport com.artipie.http.Response;\nimport com.artipie.http.auth.AuthScheme;\nimport com.artipie.http.auth.Authentication;\nimport com.artipie.http.rs.StandardRs;\nimport java.nio.ByteBuffer;\nimport java.util.Map;\nimport java.util.Optional;\nimport java.util.concurrent.CompletableFuture;\nimport java.util.concurrent.atomic.AtomicReference;\nimport org.hamcrest.MatcherAssert;\nimport org.hamcrest.core.IsEqual;\nimport org.junit.jupiter.api.Test;\nimport org.reactivestreams.Publisher;\n\n/**\n * Tests for {@link AuthScopeSlice}.\n *\n * @since 0.11\n */\nclass AuthScopeSliceTest {\n\n    @Test\n    void testScope() {\n        final String line = \"GET /resource.txt HTTP/1.1\";\n        final String action = \"foo:bar:baz\";\n        final AtomicReference<String> caction = new AtomicReference<>();\n        final AtomicReference<String> cline = new AtomicReference<>();\n        new AuthScopeSlice(\n            new ScopeSlice() {\n                @Override\n                public Scope scope(final String rqline) {\n                    cline.set(rqline);\n                    return new Scope.FromString(action);\n                }\n\n                @Override\n                public Response response(\n                    final String line,\n                    final Iterable<Map.Entry<String, String>> headers,\n                    final Publisher<ByteBuffer> body\n                ) {\n                    return StandardRs.OK;\n                }\n            },\n            (headers, rline) -> CompletableFuture.completedFuture(\n                new AuthScheme.Result() {\n                    @Override\n                    public Optional<Authentication.User> user() {\n                        return Optional.of(new Authentication.User(\"alice\"));\n                    }\n\n                    @Override\n                    public String challenge() {\n                        return \"\";\n                    }\n                }\n            ),\n            (user, act) -> {\n                caction.set(act);\n                return true;\n            }\n        ).response(line, Headers.EMPTY, Content.EMPTY).send(\n            (status, headers, body) -> CompletableFuture.allOf()\n        ).toCompletableFuture().join();\n        MatcherAssert.assertThat(\n            \"Request line passed to slice\",\n            cline.get(),\n            new IsEqual<>(line)\n        );\n        MatcherAssert.assertThat(\n            \"Scope passed as action to permissions\",\n            caction.get(),\n            new IsEqual<>(action)\n        );\n    }\n}\n\n'''\nThe error is caused by a change in the API of the dependency: http v1.1.4->v1.2.1. \nThe new library version includes the following relevant backward incompatible changes on API. \n(API changes format: lines starting with '--' denote removed members, '++' denote added ones, '~~' denote mutations with change kind) \n\n\nThe error is triggered in the following specific lines in the previous code:\n                    public Optional<Authentication.User> user() {\n                        return Optional.of(new Authentication.User(\"alice\"));\nwith the following error message:\n[ERROR] /docker-adapter/src/test/java/com/artipie/docker/http/AuthScopeSliceTest.java:[56,51] cannot find symbol  symbol:   class User\n  location: interface com.artipie.http.auth.Authentication\n[ERROR] /docker-adapter/src/test/java/com/artipie/docker/http/AuthScopeSliceTest.java:[57,62] cannot find symbol  symbol:   class User\n  location: interface com.artipie.http.auth.Authentication\n\nPlease apply your reasoning and generate the fix following the system instruction.\n",
    "buggy_lines": "                    public Optional<Authentication.User> user() {\n                        return Optional.of(new Authentication.User(\"alice\"));",
    "error_message": "[ERROR] /docker-adapter/src/test/java/com/artipie/docker/http/AuthScopeSliceTest.java:[56,51] cannot find symbol  symbol:   class User\n  location: interface com.artipie.http.auth.Authentication\n[ERROR] /docker-adapter/src/test/java/com/artipie/docker/http/AuthScopeSliceTest.java:[57,62] cannot find symbol  symbol:   class User\n  location: interface com.artipie.http.auth.Authentication",
    "api_diff": "",
    "original_code": "/*\n * The MIT License (MIT) Copyright (c) 2020-2023 artipie.com\n * https://github.com/artipie/docker-adapter/LICENSE.txt\n */\npackage com.artipie.docker.http;\n\nimport com.artipie.asto.Content;\nimport com.artipie.http.Headers;\nimport com.artipie.http.Response;\nimport com.artipie.http.auth.AuthScheme;\nimport com.artipie.http.auth.Authentication;\nimport com.artipie.http.rs.StandardRs;\nimport java.nio.ByteBuffer;\nimport java.util.Map;\nimport java.util.Optional;\nimport java.util.concurrent.CompletableFuture;\nimport java.util.concurrent.atomic.AtomicReference;\nimport org.hamcrest.MatcherAssert;\nimport org.hamcrest.core.IsEqual;\nimport org.junit.jupiter.api.Test;\nimport org.reactivestreams.Publisher;\n\n/**\n * Tests for {@link AuthScopeSlice}.\n *\n * @since 0.11\n */\nclass AuthScopeSliceTest {\n\n    @Test\n    void testScope() {\n        final String line = \"GET /resource.txt HTTP/1.1\";\n        final String action = \"foo:bar:baz\";\n        final AtomicReference<String> caction = new AtomicReference<>();\n        final AtomicReference<String> cline = new AtomicReference<>();\n        new AuthScopeSlice(\n            new ScopeSlice() {\n                @Override\n                public Scope scope(final String rqline) {\n                    cline.set(rqline);\n                    return new Scope.FromString(action);\n                }\n\n                @Override\n                public Response response(\n                    final String line,\n                    final Iterable<Map.Entry<String, String>> headers,\n                    final Publisher<ByteBuffer> body\n                ) {\n                    return StandardRs.OK;\n                }\n            },\n            (headers, rline) -> CompletableFuture.completedFuture(\n                new AuthScheme.Result() {\n                    @Override\n                    public Optional<Authentication.User> user() {\n                        return Optional.of(new Authentication.User(\"alice\"));\n                    }\n\n                    @Override\n                    public String challenge() {\n                        return \"\";\n                    }\n                }\n            ),\n            (user, act) -> {\n                caction.set(act);\n                return true;\n            }\n        ).response(line, Headers.EMPTY, Content.EMPTY).send(\n            (status, headers, body) -> CompletableFuture.allOf()\n        ).toCompletableFuture().join();\n        MatcherAssert.assertThat(\n            \"Request line passed to slice\",\n            cline.get(),\n            new IsEqual<>(line)\n        );\n        MatcherAssert.assertThat(\n            \"Scope passed as action to permissions\",\n            caction.get(),\n            new IsEqual<>(action)\n        );\n    }\n}\n",
    "project": "docker-adapter",
    "libraryName": "http",
    "libraryGroupID": "com.artipie",
    "newVersion": "v1.2.1",
    "previousVersion": "v1.1.4",
    "breakingCommit": "d38182a8a0fe1ec039aed97e103864fce717a0be"
}