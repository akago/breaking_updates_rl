{
    "absolute_path_to_file_in_container": "/java-api/src/main/java/io/zold/api/RtTransaction.java",
    "errors": [
        {
            "line_number": 33,
            "message": "[ERROR] /java-api/src/main/java/io/zold/api/RtTransaction.java:[33,28] cannot find symbol",
            "additional_info": "  symbol:   class LengthOf\n  location: package org.cactoos.iterable",
            "file_name": "RtTransaction.java",
            "BCs": [
                {
                    "element": "org.cactoos.io.LengthOf",
                    "nature": "DELETION",
                    "kind": "TYPE_REMOVED"
                },
                {
                    "element": "org.cactoos.iterable.LengthOf",
                    "nature": "DELETION",
                    "kind": "TYPE_REMOVED"
                },
                {
                    "element": "org.cactoos.iterator.LengthOf",
                    "nature": "DELETION",
                    "kind": "TYPE_REMOVED"
                }
            ],
            "Additions": [
                "++ public final null org.cactoos.scalar.LengthOf",
                "++ public final null org.cactoos.scalar.LengthOf",
                "++ public LengthOf org.cactoos.scalar.LengthOf(org.cactoos.Text)",
                "++ public LengthOf org.cactoos.scalar.LengthOf(org.cactoos.Text)",
                "++ public LengthOf org.cactoos.scalar.LengthOf(org.cactoos.Input,int)",
                "++ public LengthOf org.cactoos.scalar.LengthOf(org.cactoos.Input,int)",
                "++ public LengthOf org.cactoos.scalar.LengthOf(org.cactoos.Input)",
                "++ public LengthOf org.cactoos.scalar.LengthOf(org.cactoos.Input)",
                "++ public LengthOf org.cactoos.scalar.LengthOf(java.lang.Iterable)",
                "++ public LengthOf org.cactoos.scalar.LengthOf(java.lang.Iterable)"
            ],
            "uid": "919fd937-e7c6-54f5-b9ae-09975f6732db"
        },
        {
            "line_number": 35,
            "message": "[ERROR] /java-api/src/main/java/io/zold/api/RtTransaction.java:[35,26] cannot find symbol",
            "additional_info": "  symbol:   class IoCheckedScalar\n  location: package org.cactoos.scalar",
            "file_name": "RtTransaction.java",
            "BCs": [
                {
                    "element": "org.cactoos.scalar.CheckedScalar",
                    "nature": "DELETION",
                    "kind": "TYPE_REMOVED"
                },
                {
                    "element": "org.cactoos.scalar.IoCheckedScalar",
                    "nature": "DELETION",
                    "kind": "TYPE_REMOVED"
                }
            ],
            "Additions": [],
            "uid": "13898992-71c5-57a2-98e6-9b4004b1e56b"
        },
        {
            "line_number": 37,
            "message": "[ERROR] /java-api/src/main/java/io/zold/api/RtTransaction.java:[37,26] cannot find symbol",
            "additional_info": "  symbol:   class StickyScalar\n  location: package org.cactoos.scalar",
            "file_name": "RtTransaction.java",
            "BCs": [
                {
                    "element": "org.cactoos.scalar.StickyScalar",
                    "nature": "DELETION",
                    "kind": "TYPE_REMOVED"
                }
            ],
            "Additions": [],
            "uid": "f28d7ea4-f128-5007-9b1f-07d76918482d"
        },
        {
            "line_number": 38,
            "message": "[ERROR] /java-api/src/main/java/io/zold/api/RtTransaction.java:[38,26] cannot find symbol",
            "additional_info": "  symbol:   class UncheckedScalar\n  location: package org.cactoos.scalar",
            "file_name": "RtTransaction.java",
            "BCs": [
                {
                    "element": "org.cactoos.scalar.UncheckedScalar",
                    "nature": "DELETION",
                    "kind": "TYPE_REMOVED"
                }
            ],
            "Additions": [],
            "uid": "4be3b2c3-6895-545e-8c0a-8a23924abdd6"
        },
        {
            "line_number": 40,
            "message": "[ERROR] /java-api/src/main/java/io/zold/api/RtTransaction.java:[40,24] cannot find symbol",
            "additional_info": "  symbol:   class SplitText\n  location: package org.cactoos.text",
            "file_name": "RtTransaction.java",
            "BCs": [
                {
                    "element": "org.cactoos.text.SplitText",
                    "nature": "DELETION",
                    "kind": "TYPE_REMOVED"
                }
            ],
            "Additions": [],
            "uid": "7b25bf9e-0a3a-503e-b254-9df79f0be06a"
        },
        {
            "line_number": 42,
            "message": "[ERROR] /java-api/src/main/java/io/zold/api/RtTransaction.java:[42,24] cannot find symbol",
            "additional_info": "  symbol:   class TrimmedText\n  location: package org.cactoos.text",
            "file_name": "RtTransaction.java",
            "BCs": [
                {
                    "element": "org.cactoos.text.TrimmedText",
                    "nature": "DELETION",
                    "kind": "TYPE_REMOVED"
                }
            ],
            "Additions": [],
            "uid": "37440c9c-bff7-577e-a321-215be88b643a"
        },
        {
            "line_number": 88,
            "message": "[ERROR] /java-api/src/main/java/io/zold/api/RtTransaction.java:[88,19] cannot find symbol",
            "additional_info": "  symbol:   class IoCheckedScalar\n  location: class io.zold.api.RtTransaction",
            "file_name": "RtTransaction.java",
            "BCs": [
                {
                    "element": "org.cactoos.scalar.CheckedScalar",
                    "nature": "DELETION",
                    "kind": "TYPE_REMOVED"
                },
                {
                    "element": "org.cactoos.scalar.IoCheckedScalar",
                    "nature": "DELETION",
                    "kind": "TYPE_REMOVED"
                }
            ],
            "Additions": [],
            "uid": "c2d8c4ea-12e9-5338-a18f-c47ec16e40c8"
        }
    ],
    "prompt": "\nThe following Java client code fails: \n'''java\n/*\n * The MIT License (MIT)\n *\n * Copyright (c) 2018-2023 Yegor Bugayenko\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included\n * in all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n */\npackage io.zold.api;\n\nimport java.io.IOException;\nimport java.math.BigInteger;\nimport java.time.ZonedDateTime;\nimport java.time.format.DateTimeFormatter;\nimport java.util.List;\nimport java.util.regex.Pattern;\nimport org.cactoos.Text;\nimport org.cactoos.iterable.LengthOf;\nimport org.cactoos.list.ListOf;\nimport org.cactoos.scalar.IoCheckedScalar;\nimport org.cactoos.scalar.ItemAt;\nimport org.cactoos.scalar.StickyScalar;\nimport org.cactoos.scalar.UncheckedScalar;\nimport org.cactoos.text.FormattedText;\nimport org.cactoos.text.SplitText;\nimport org.cactoos.text.TextOf;\nimport org.cactoos.text.TrimmedText;\nimport org.cactoos.text.UncheckedText;\nimport org.cactoos.time.ZonedDateTimeOf;\n\n/**\n * RtTransaction.\n *\n * @since 0.1\n * @checkstyle ClassDataAbstractionCoupling (3 lines)\n */\n@SuppressWarnings({\"PMD.AvoidCatchingGenericException\",\n    \"PMD.AvoidFieldNameMatchingMethodName\"})\nfinal class RtTransaction implements Transaction {\n\n    /**\n     * Pattern for Prefix String.\n     */\n    private static final Pattern PREFIX = Pattern.compile(\n        //@checkstyle LineLengthCheck (1 line)\n        \"^([A-Za-z0-9+\\\\/]{4})*([A-Za-z0-9+\\\\/]{4}|[A-Za-z0-9+\\\\/]{3}=|[A-Za-z0-9+\\\\/]{2}==)$\"\n    );\n\n    /**\n     * Pattern for 16 symbol hex string.\n     */\n    private static final Pattern HEX = Pattern.compile(\"[A-Fa-f0-9]{16}\");\n\n    /**\n     * Pattern for parsing Signature.\n     */\n    private static final Pattern SIGN = Pattern.compile(\"[A-Za-z0-9+/]+={0,3}\");\n\n    /**\n     * Pattern for Details string.\n     */\n    private static final Pattern DTLS =\n        Pattern.compile(\"[A-Za-z0-9 -.]{1,512}\");\n\n    /**\n     * Pattern for ID String.\n     */\n    private static final Pattern IDENT = Pattern.compile(\"[A-Fa-f0-9]{4}\");\n\n    /**\n     * String representation of transaction.\n     */\n    private final IoCheckedScalar<String> transaction;\n\n    /**\n     * Ctor.\n     * @param trnsct String representation of transaction\n     */\n    RtTransaction(final String trnsct) {\n        this.transaction = new IoCheckedScalar<>(\n            new StickyScalar<>(\n                () -> {\n                    if (\n                        new TrimmedText(\n                            new TextOf(trnsct)\n                        ).asString().isEmpty()\n                    ) {\n                        throw new IOException(\n                            \"Invalid transaction string: string is empty\"\n                        );\n                    }\n                    final List<Text> pieces =\n                        new ListOf<>(\n                            new SplitText(trnsct, \";\")\n                        );\n                    // @checkstyle MagicNumberCheck (1 line)\n                    if (new LengthOf(pieces).intValue() != 7) {\n                        throw new IOException(\n                            new FormattedText(\n                                // @checkstyle LineLength (1 line)\n                                \"Invalid transaction string: expected 7 fields, but found %d\",\n                                pieces.size()\n                            ).asString()\n                        );\n                    }\n                    return trnsct;\n                }\n            )\n        );\n    }\n\n    @Override\n    @SuppressWarnings(\"PMD.ShortMethodName\")\n    public int id() throws IOException {\n        final String ident = new UncheckedText(\n            new IoCheckedScalar<>(\n                new ItemAt<>(\n                    0, new SplitText(this.transaction.value(), \";\")\n                )\n            ).value()\n        ).asString();\n        if (!RtTransaction.IDENT.matcher(ident).matches()) {\n            throw new IOException(\n                new UncheckedText(\n                    new FormattedText(\n                        // @checkstyle LineLength (1 line)\n                        \"Invalid ID '%s' expecting 16-bit unsigned hex string with 4 symbols\",\n                        ident\n                    )\n                ).asString()\n            );\n        }\n        // @checkstyle MagicNumber (1 line)\n        return Integer.parseUnsignedInt(ident, 16);\n    }\n\n    @Override\n    public ZonedDateTime time() throws IOException {\n        return new ZonedDateTimeOf(\n            new UncheckedText(\n                new IoCheckedScalar<>(\n                    new ItemAt<>(\n                        1, new SplitText(this.transaction.value(), \";\")\n                    )\n                ).value()\n            ).asString(),\n            DateTimeFormatter.ISO_OFFSET_DATE_TIME\n        ).value();\n    }\n\n    @Override\n    public long amount() throws IOException {\n        final String amnt = new UncheckedText(\n            new IoCheckedScalar<>(\n                new ItemAt<>(\n                    2, new SplitText(this.transaction.value(), \";\")\n                )\n            ).value()\n        ).asString();\n        if (!RtTransaction.HEX.matcher(amnt).matches()) {\n            throw new IOException(\n                new UncheckedText(\n                    new FormattedText(\n                        // @checkstyle LineLength (1 line)\n                        \"Invalid amount '%s' expecting 64-bit signed hex string with 16 symbols\",\n                        amnt\n                    )\n                ).asString()\n            );\n        }\n        // @checkstyle MagicNumber (1 line)\n        return new BigInteger(amnt, 16).longValue();\n    }\n\n    @Override\n    public String prefix() throws IOException {\n        final String prefix = new UncheckedText(\n            new IoCheckedScalar<>(\n                new ItemAt<>(\n                    //@checkstyle MagicNumberCheck (1 line)\n                    3, new SplitText(this.transaction.value(), \";\")\n                )\n            ).value()\n        ).asString();\n        //@checkstyle MagicNumberCheck (1 line)\n        if (prefix.length() < 8 || prefix.length() > 32) {\n            throw new IOException(\"Invalid prefix size\");\n        }\n        if (!RtTransaction.PREFIX.matcher(prefix).matches()) {\n            throw new IOException(\"Invalid base64 prefix\");\n        }\n        return prefix;\n    }\n\n    @Override\n    public String bnf() throws IOException {\n        final String bnf = new UncheckedText(\n            new IoCheckedScalar<>(\n                new ItemAt<>(\n                    //@checkstyle MagicNumberCheck (1 line)\n                    4, new SplitText(this.transaction.value(), \";\")\n                )\n            ).value()\n        ).asString();\n        if (!RtTransaction.HEX.matcher(bnf).matches()) {\n            throw new IOException(\n                new UncheckedText(\n                    new FormattedText(\n                        // @checkstyle LineLength (1 line)\n                        \"Invalid bnf string '%s', expecting hex string with 16 symbols\",\n                        bnf\n                    )\n                ).asString()\n            );\n        }\n        return bnf;\n    }\n\n    @Override\n    public String details() throws IOException {\n        final String dtls = new UncheckedText(\n            new IoCheckedScalar<>(\n                new ItemAt<>(\n                    //@checkstyle MagicNumberCheck (1 line)\n                    5, new SplitText(this.transaction.value(), \";\")\n                )\n            ).value()\n        ).asString();\n        if (!RtTransaction.DTLS.matcher(dtls).matches()) {\n            throw new IOException(\n                new UncheckedText(\n                    new FormattedText(\n                        // @checkstyle LineLength (1 line)\n                        \"Invalid details string '%s', does not match pattern '%s'\",\n                        dtls, RtTransaction.DTLS\n                    )\n                ).asString()\n            );\n        }\n        return dtls;\n    }\n\n    @Override\n    public String signature() throws IOException {\n        final String sign = new UncheckedText(\n            new IoCheckedScalar<>(\n                new ItemAt<>(\n                    //@checkstyle MagicNumberCheck (1 line)\n                    6, new SplitText(this.transaction.value(), \";\")\n                )\n            ).value()\n        ).asString();\n        // @checkstyle MagicNumber (1 line)\n        if (sign.length() != 684\n            || !RtTransaction.SIGN.matcher(sign).matches()) {\n            throw new IOException(\n                new UncheckedText(\n                    new FormattedText(\n                        // @checkstyle LineLength (1 line)\n                        \"Invalid signature '%s', expecting base64 string with 684 characters\",\n                        sign\n                    )\n                ).asString()\n            );\n        }\n        return sign;\n    }\n\n    @Override\n    public String toString() {\n        return new UncheckedScalar<>(this.transaction).value();\n    }\n\n    @Override\n    @SuppressWarnings(\"PMD.OnlyOneReturn\")\n    public boolean equals(final Object obj) {\n        if (this == obj) {\n            return true;\n        }\n        if (obj == null || this.getClass() != obj.getClass()) {\n            return false;\n        }\n        final RtTransaction that = (RtTransaction) obj;\n        return this.transaction.equals(that.transaction);\n    }\n\n    @Override\n    public int hashCode() {\n        return this.transaction.hashCode();\n    }\n}\n\n'''\nThe error is caused by a change in the API of the dependency: cactoos 0.35->0.55.0. \nThe new library version includes the following relevant backward incompatible changes on API. \n(API changes format: lines starting with '--' denote removed members, '++' denote added ones, '~~' denote mutations with change kind) \n-- org.cactoos.io.LengthOf\n-- org.cactoos.iterable.LengthOf\n-- org.cactoos.iterator.LengthOf\n-- org.cactoos.collection.CollectionOf\n-- org.cactoos.text.RandomText\n-- org.cactoos.collection.Filtered\n-- org.cactoos.scalar.CheckedScalar\n-- org.cactoos.scalar.UncheckedScalar\n-- org.cactoos.text.SplitText\n-- org.cactoos.scalar.IoCheckedScalar\n-- org.cactoos.scalar.SolidScalar\n-- org.cactoos.text.JoinedText\n-- org.cactoos.scalar.StickyScalar\n-- org.cactoos.text.TrimmedText\n++ public LengthOf org.cactoos.scalar.LengthOf(java.lang.Iterable)\n++ public LengthOf org.cactoos.scalar.LengthOf(org.cactoos.Text)\n++ public LengthOf org.cactoos.scalar.LengthOf(org.cactoos.Input,int)\n++ public final null org.cactoos.scalar.LengthOf\n++ public Filtered org.cactoos.iterable.Filtered(java.lang.Iterable,org.cactoos.Func)\n++ public LengthOf org.cactoos.scalar.LengthOf(org.cactoos.Input)\n++ public Filtered org.cactoos.iterator.Filtered(java.util.Iterator,org.cactoos.Func)\n\nThe error is triggered in the following specific lines in the previous code:\nimport org.cactoos.iterable.LengthOf;\nimport org.cactoos.scalar.IoCheckedScalar;\nimport org.cactoos.scalar.StickyScalar;\nimport org.cactoos.scalar.UncheckedScalar;\nimport org.cactoos.text.SplitText;\nimport org.cactoos.text.TrimmedText;\n    private final IoCheckedScalar<String> transaction;\nwith the following error message:\n[ERROR] /java-api/src/main/java/io/zold/api/RtTransaction.java:[33,28] cannot find symbol  symbol:   class LengthOf\n  location: package org.cactoos.iterable\n[ERROR] /java-api/src/main/java/io/zold/api/RtTransaction.java:[35,26] cannot find symbol  symbol:   class IoCheckedScalar\n  location: package org.cactoos.scalar\n[ERROR] /java-api/src/main/java/io/zold/api/RtTransaction.java:[37,26] cannot find symbol  symbol:   class StickyScalar\n  location: package org.cactoos.scalar\n[ERROR] /java-api/src/main/java/io/zold/api/RtTransaction.java:[38,26] cannot find symbol  symbol:   class UncheckedScalar\n  location: package org.cactoos.scalar\n[ERROR] /java-api/src/main/java/io/zold/api/RtTransaction.java:[40,24] cannot find symbol  symbol:   class SplitText\n  location: package org.cactoos.text\n[ERROR] /java-api/src/main/java/io/zold/api/RtTransaction.java:[42,24] cannot find symbol  symbol:   class TrimmedText\n  location: package org.cactoos.text\n[ERROR] /java-api/src/main/java/io/zold/api/RtTransaction.java:[88,19] cannot find symbol  symbol:   class IoCheckedScalar\n  location: class io.zold.api.RtTransaction\n\nPlease apply your reasoning and generate the fix following the system instruction.\n",
    "buggy_lines": "import org.cactoos.iterable.LengthOf;\nimport org.cactoos.scalar.IoCheckedScalar;\nimport org.cactoos.scalar.StickyScalar;\nimport org.cactoos.scalar.UncheckedScalar;\nimport org.cactoos.text.SplitText;\nimport org.cactoos.text.TrimmedText;\n    private final IoCheckedScalar<String> transaction;",
    "error_message": "[ERROR] /java-api/src/main/java/io/zold/api/RtTransaction.java:[33,28] cannot find symbol  symbol:   class LengthOf\n  location: package org.cactoos.iterable\n[ERROR] /java-api/src/main/java/io/zold/api/RtTransaction.java:[35,26] cannot find symbol  symbol:   class IoCheckedScalar\n  location: package org.cactoos.scalar\n[ERROR] /java-api/src/main/java/io/zold/api/RtTransaction.java:[37,26] cannot find symbol  symbol:   class StickyScalar\n  location: package org.cactoos.scalar\n[ERROR] /java-api/src/main/java/io/zold/api/RtTransaction.java:[38,26] cannot find symbol  symbol:   class UncheckedScalar\n  location: package org.cactoos.scalar\n[ERROR] /java-api/src/main/java/io/zold/api/RtTransaction.java:[40,24] cannot find symbol  symbol:   class SplitText\n  location: package org.cactoos.text\n[ERROR] /java-api/src/main/java/io/zold/api/RtTransaction.java:[42,24] cannot find symbol  symbol:   class TrimmedText\n  location: package org.cactoos.text\n[ERROR] /java-api/src/main/java/io/zold/api/RtTransaction.java:[88,19] cannot find symbol  symbol:   class IoCheckedScalar\n  location: class io.zold.api.RtTransaction",
    "api_diff": "-- org.cactoos.io.LengthOf\n-- org.cactoos.iterable.LengthOf\n-- org.cactoos.iterator.LengthOf\n-- org.cactoos.collection.CollectionOf\n-- org.cactoos.text.RandomText\n-- org.cactoos.collection.Filtered\n-- org.cactoos.scalar.CheckedScalar\n-- org.cactoos.scalar.UncheckedScalar\n-- org.cactoos.text.SplitText\n-- org.cactoos.scalar.IoCheckedScalar\n-- org.cactoos.scalar.SolidScalar\n-- org.cactoos.text.JoinedText\n-- org.cactoos.scalar.StickyScalar\n-- org.cactoos.text.TrimmedText\n++ public LengthOf org.cactoos.scalar.LengthOf(java.lang.Iterable)\n++ public LengthOf org.cactoos.scalar.LengthOf(org.cactoos.Text)\n++ public LengthOf org.cactoos.scalar.LengthOf(org.cactoos.Input,int)\n++ public final null org.cactoos.scalar.LengthOf\n++ public Filtered org.cactoos.iterable.Filtered(java.lang.Iterable,org.cactoos.Func)\n++ public LengthOf org.cactoos.scalar.LengthOf(org.cactoos.Input)\n++ public Filtered org.cactoos.iterator.Filtered(java.util.Iterator,org.cactoos.Func)",
    "original_code": "/*\n * The MIT License (MIT)\n *\n * Copyright (c) 2018-2023 Yegor Bugayenko\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included\n * in all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n */\npackage io.zold.api;\n\nimport java.io.IOException;\nimport java.math.BigInteger;\nimport java.time.ZonedDateTime;\nimport java.time.format.DateTimeFormatter;\nimport java.util.List;\nimport java.util.regex.Pattern;\nimport org.cactoos.Text;\nimport org.cactoos.iterable.LengthOf;\nimport org.cactoos.list.ListOf;\nimport org.cactoos.scalar.IoCheckedScalar;\nimport org.cactoos.scalar.ItemAt;\nimport org.cactoos.scalar.StickyScalar;\nimport org.cactoos.scalar.UncheckedScalar;\nimport org.cactoos.text.FormattedText;\nimport org.cactoos.text.SplitText;\nimport org.cactoos.text.TextOf;\nimport org.cactoos.text.TrimmedText;\nimport org.cactoos.text.UncheckedText;\nimport org.cactoos.time.ZonedDateTimeOf;\n\n/**\n * RtTransaction.\n *\n * @since 0.1\n * @checkstyle ClassDataAbstractionCoupling (3 lines)\n */\n@SuppressWarnings({\"PMD.AvoidCatchingGenericException\",\n    \"PMD.AvoidFieldNameMatchingMethodName\"})\nfinal class RtTransaction implements Transaction {\n\n    /**\n     * Pattern for Prefix String.\n     */\n    private static final Pattern PREFIX = Pattern.compile(\n        //@checkstyle LineLengthCheck (1 line)\n        \"^([A-Za-z0-9+\\\\/]{4})*([A-Za-z0-9+\\\\/]{4}|[A-Za-z0-9+\\\\/]{3}=|[A-Za-z0-9+\\\\/]{2}==)$\"\n    );\n\n    /**\n     * Pattern for 16 symbol hex string.\n     */\n    private static final Pattern HEX = Pattern.compile(\"[A-Fa-f0-9]{16}\");\n\n    /**\n     * Pattern for parsing Signature.\n     */\n    private static final Pattern SIGN = Pattern.compile(\"[A-Za-z0-9+/]+={0,3}\");\n\n    /**\n     * Pattern for Details string.\n     */\n    private static final Pattern DTLS =\n        Pattern.compile(\"[A-Za-z0-9 -.]{1,512}\");\n\n    /**\n     * Pattern for ID String.\n     */\n    private static final Pattern IDENT = Pattern.compile(\"[A-Fa-f0-9]{4}\");\n\n    /**\n     * String representation of transaction.\n     */\n    private final IoCheckedScalar<String> transaction;\n\n    /**\n     * Ctor.\n     * @param trnsct String representation of transaction\n     */\n    RtTransaction(final String trnsct) {\n        this.transaction = new IoCheckedScalar<>(\n            new StickyScalar<>(\n                () -> {\n                    if (\n                        new TrimmedText(\n                            new TextOf(trnsct)\n                        ).asString().isEmpty()\n                    ) {\n                        throw new IOException(\n                            \"Invalid transaction string: string is empty\"\n                        );\n                    }\n                    final List<Text> pieces =\n                        new ListOf<>(\n                            new SplitText(trnsct, \";\")\n                        );\n                    // @checkstyle MagicNumberCheck (1 line)\n                    if (new LengthOf(pieces).intValue() != 7) {\n                        throw new IOException(\n                            new FormattedText(\n                                // @checkstyle LineLength (1 line)\n                                \"Invalid transaction string: expected 7 fields, but found %d\",\n                                pieces.size()\n                            ).asString()\n                        );\n                    }\n                    return trnsct;\n                }\n            )\n        );\n    }\n\n    @Override\n    @SuppressWarnings(\"PMD.ShortMethodName\")\n    public int id() throws IOException {\n        final String ident = new UncheckedText(\n            new IoCheckedScalar<>(\n                new ItemAt<>(\n                    0, new SplitText(this.transaction.value(), \";\")\n                )\n            ).value()\n        ).asString();\n        if (!RtTransaction.IDENT.matcher(ident).matches()) {\n            throw new IOException(\n                new UncheckedText(\n                    new FormattedText(\n                        // @checkstyle LineLength (1 line)\n                        \"Invalid ID '%s' expecting 16-bit unsigned hex string with 4 symbols\",\n                        ident\n                    )\n                ).asString()\n            );\n        }\n        // @checkstyle MagicNumber (1 line)\n        return Integer.parseUnsignedInt(ident, 16);\n    }\n\n    @Override\n    public ZonedDateTime time() throws IOException {\n        return new ZonedDateTimeOf(\n            new UncheckedText(\n                new IoCheckedScalar<>(\n                    new ItemAt<>(\n                        1, new SplitText(this.transaction.value(), \";\")\n                    )\n                ).value()\n            ).asString(),\n            DateTimeFormatter.ISO_OFFSET_DATE_TIME\n        ).value();\n    }\n\n    @Override\n    public long amount() throws IOException {\n        final String amnt = new UncheckedText(\n            new IoCheckedScalar<>(\n                new ItemAt<>(\n                    2, new SplitText(this.transaction.value(), \";\")\n                )\n            ).value()\n        ).asString();\n        if (!RtTransaction.HEX.matcher(amnt).matches()) {\n            throw new IOException(\n                new UncheckedText(\n                    new FormattedText(\n                        // @checkstyle LineLength (1 line)\n                        \"Invalid amount '%s' expecting 64-bit signed hex string with 16 symbols\",\n                        amnt\n                    )\n                ).asString()\n            );\n        }\n        // @checkstyle MagicNumber (1 line)\n        return new BigInteger(amnt, 16).longValue();\n    }\n\n    @Override\n    public String prefix() throws IOException {\n        final String prefix = new UncheckedText(\n            new IoCheckedScalar<>(\n                new ItemAt<>(\n                    //@checkstyle MagicNumberCheck (1 line)\n                    3, new SplitText(this.transaction.value(), \";\")\n                )\n            ).value()\n        ).asString();\n        //@checkstyle MagicNumberCheck (1 line)\n        if (prefix.length() < 8 || prefix.length() > 32) {\n            throw new IOException(\"Invalid prefix size\");\n        }\n        if (!RtTransaction.PREFIX.matcher(prefix).matches()) {\n            throw new IOException(\"Invalid base64 prefix\");\n        }\n        return prefix;\n    }\n\n    @Override\n    public String bnf() throws IOException {\n        final String bnf = new UncheckedText(\n            new IoCheckedScalar<>(\n                new ItemAt<>(\n                    //@checkstyle MagicNumberCheck (1 line)\n                    4, new SplitText(this.transaction.value(), \";\")\n                )\n            ).value()\n        ).asString();\n        if (!RtTransaction.HEX.matcher(bnf).matches()) {\n            throw new IOException(\n                new UncheckedText(\n                    new FormattedText(\n                        // @checkstyle LineLength (1 line)\n                        \"Invalid bnf string '%s', expecting hex string with 16 symbols\",\n                        bnf\n                    )\n                ).asString()\n            );\n        }\n        return bnf;\n    }\n\n    @Override\n    public String details() throws IOException {\n        final String dtls = new UncheckedText(\n            new IoCheckedScalar<>(\n                new ItemAt<>(\n                    //@checkstyle MagicNumberCheck (1 line)\n                    5, new SplitText(this.transaction.value(), \";\")\n                )\n            ).value()\n        ).asString();\n        if (!RtTransaction.DTLS.matcher(dtls).matches()) {\n            throw new IOException(\n                new UncheckedText(\n                    new FormattedText(\n                        // @checkstyle LineLength (1 line)\n                        \"Invalid details string '%s', does not match pattern '%s'\",\n                        dtls, RtTransaction.DTLS\n                    )\n                ).asString()\n            );\n        }\n        return dtls;\n    }\n\n    @Override\n    public String signature() throws IOException {\n        final String sign = new UncheckedText(\n            new IoCheckedScalar<>(\n                new ItemAt<>(\n                    //@checkstyle MagicNumberCheck (1 line)\n                    6, new SplitText(this.transaction.value(), \";\")\n                )\n            ).value()\n        ).asString();\n        // @checkstyle MagicNumber (1 line)\n        if (sign.length() != 684\n            || !RtTransaction.SIGN.matcher(sign).matches()) {\n            throw new IOException(\n                new UncheckedText(\n                    new FormattedText(\n                        // @checkstyle LineLength (1 line)\n                        \"Invalid signature '%s', expecting base64 string with 684 characters\",\n                        sign\n                    )\n                ).asString()\n            );\n        }\n        return sign;\n    }\n\n    @Override\n    public String toString() {\n        return new UncheckedScalar<>(this.transaction).value();\n    }\n\n    @Override\n    @SuppressWarnings(\"PMD.OnlyOneReturn\")\n    public boolean equals(final Object obj) {\n        if (this == obj) {\n            return true;\n        }\n        if (obj == null || this.getClass() != obj.getClass()) {\n            return false;\n        }\n        final RtTransaction that = (RtTransaction) obj;\n        return this.transaction.equals(that.transaction);\n    }\n\n    @Override\n    public int hashCode() {\n        return this.transaction.hashCode();\n    }\n}\n",
    "project": "java-api",
    "libraryName": "cactoos",
    "libraryGroupID": "org.cactoos",
    "newVersion": "0.55.0",
    "previousVersion": "0.35",
    "breakingCommit": "38c9915f0cfdf0c1a2b17c3c6f283c23a0aac0cf"
}