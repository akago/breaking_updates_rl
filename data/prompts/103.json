{
    "absolute_path_to_file_in_container": "/java-bitpay-client/src/setup/java/BitPaySetup.java",
    "errors": [
        {
            "line_number": 23,
            "message": "[ERROR] /java-bitpay-client/src/setup/java/BitPaySetup.java:[23,25] cannot find symbol",
            "additional_info": "  symbol:   class ECKey\n  location: package org.bitcoinj.core",
            "file_name": "BitPaySetup.java",
            "BCs": [
                {
                    "element": "org.bitcoinj.core.ECKey",
                    "nature": "DELETION",
                    "kind": "TYPE_REMOVED"
                }
            ],
            "Additions": [
                "++ public null org.bitcoinj.crypto.ECKey",
                "++ public null org.bitcoinj.crypto.ECKey",
                "++ protected ECKey org.bitcoinj.crypto.ECKey(java.math.BigInteger,org.bitcoinj.crypto.LazyECPoint)",
                "++ protected ECKey org.bitcoinj.crypto.ECKey(java.math.BigInteger,org.bitcoinj.crypto.LazyECPoint)",
                "++ public ECKey org.bitcoinj.crypto.ECKey()",
                "++ public ECKey org.bitcoinj.crypto.ECKey()",
                "++ protected ECKey org.bitcoinj.crypto.ECKey(java.math.BigInteger,org.bouncycastle.math.ec.ECPoint,boolean)",
                "++ protected ECKey org.bitcoinj.crypto.ECKey(java.math.BigInteger,org.bouncycastle.math.ec.ECPoint,boolean)",
                "++ public ECKey org.bitcoinj.crypto.ECKey(java.security.SecureRandom)",
                "++ public ECKey org.bitcoinj.crypto.ECKey(java.security.SecureRandom)"
            ],
            "uid": "cc020c69-d347-5a3f-905d-f1d178791537"
        },
        {
            "line_number": 76,
            "message": "[ERROR] /java-bitpay-client/src/setup/java/BitPaySetup.java:[76,27] cannot find symbol",
            "additional_info": "  symbol:   class ECKey\n  location: class BitPaySetup",
            "file_name": "BitPaySetup.java",
            "BCs": [
                {
                    "element": "org.bitcoinj.core.ECKey",
                    "nature": "DELETION",
                    "kind": "TYPE_REMOVED"
                }
            ],
            "Additions": [
                "++ public null org.bitcoinj.crypto.ECKey",
                "++ public null org.bitcoinj.crypto.ECKey",
                "++ protected ECKey org.bitcoinj.crypto.ECKey(java.math.BigInteger,org.bitcoinj.crypto.LazyECPoint)",
                "++ protected ECKey org.bitcoinj.crypto.ECKey(java.math.BigInteger,org.bitcoinj.crypto.LazyECPoint)",
                "++ public ECKey org.bitcoinj.crypto.ECKey()",
                "++ public ECKey org.bitcoinj.crypto.ECKey()",
                "++ protected ECKey org.bitcoinj.crypto.ECKey(java.math.BigInteger,org.bouncycastle.math.ec.ECPoint,boolean)",
                "++ protected ECKey org.bitcoinj.crypto.ECKey(java.math.BigInteger,org.bouncycastle.math.ec.ECPoint,boolean)",
                "++ public ECKey org.bitcoinj.crypto.ECKey(java.security.SecureRandom)",
                "++ public ECKey org.bitcoinj.crypto.ECKey(java.security.SecureRandom)"
            ],
            "uid": "7dd09ccd-3116-552a-b803-27ca017b057b"
        },
        {
            "line_number": 86,
            "message": "[ERROR] /java-bitpay-client/src/setup/java/BitPaySetup.java:[86,23] cannot find symbol",
            "additional_info": "  symbol:   class ECKey\n  location: class BitPaySetup",
            "file_name": "BitPaySetup.java",
            "BCs": [
                {
                    "element": "org.bitcoinj.core.ECKey",
                    "nature": "DELETION",
                    "kind": "TYPE_REMOVED"
                }
            ],
            "Additions": [
                "++ public null org.bitcoinj.crypto.ECKey",
                "++ public null org.bitcoinj.crypto.ECKey",
                "++ protected ECKey org.bitcoinj.crypto.ECKey(java.math.BigInteger,org.bitcoinj.crypto.LazyECPoint)",
                "++ protected ECKey org.bitcoinj.crypto.ECKey(java.math.BigInteger,org.bitcoinj.crypto.LazyECPoint)",
                "++ public ECKey org.bitcoinj.crypto.ECKey()",
                "++ public ECKey org.bitcoinj.crypto.ECKey()",
                "++ protected ECKey org.bitcoinj.crypto.ECKey(java.math.BigInteger,org.bouncycastle.math.ec.ECPoint,boolean)",
                "++ protected ECKey org.bitcoinj.crypto.ECKey(java.math.BigInteger,org.bouncycastle.math.ec.ECPoint,boolean)",
                "++ public ECKey org.bitcoinj.crypto.ECKey(java.security.SecureRandom)",
                "++ public ECKey org.bitcoinj.crypto.ECKey(java.security.SecureRandom)"
            ],
            "uid": "7dd09ccd-3116-552a-b803-27ca017b057b"
        }
    ],
    "prompt": "\nThe following Java client code fails: \n'''java\n/*\n * Copyright (c) 2019 BitPay.\n * All rights reserved.\n */\n\nimport com.bitpay.sdk.Client;\nimport com.bitpay.sdk.Config;\nimport com.bitpay.sdk.Environment;\nimport com.bitpay.sdk.PrivateKey;\nimport com.bitpay.sdk.model.Facade;\nimport com.bitpay.sdk.util.KeyUtils;\nimport com.bitpay.sdk.util.TokenContainer;\nimport com.fasterxml.jackson.core.util.DefaultPrettyPrinter;\nimport com.fasterxml.jackson.databind.JsonNode;\nimport com.fasterxml.jackson.databind.ObjectMapper;\nimport com.fasterxml.jackson.databind.ObjectWriter;\nimport com.fasterxml.jackson.databind.node.ObjectNode;\nimport java.io.File;\nimport java.nio.file.Paths;\nimport java.util.HashMap;\nimport java.util.Scanner;\nimport java.util.concurrent.atomic.AtomicReference;\nimport org.bitcoinj.core.ECKey;\n\npublic class BitPaySetup {\n    public static void main(final String[] args) {\n        final Scanner scanner = new Scanner(System.in);\n        String opt;\n        final Environment env;\n        String privateKeyPath = \"\";\n        String privateKeyAsHex = \"\";\n        final String pairingCodeMerchant;\n        final String pairingCodePayout;\n        String privateKey = \"\";\n        final int keyType; // 1 = in file, 2 = as text\n        final Client client;\n\n        do {\n            System.out.println(\"Select target environment:\");\n            System.out.println(\"Press T for testing or P for production:\");\n            opt = scanner.next();\n        } while (\"t\".equals(opt.toLowerCase()) && \"p\".equals(opt.toLowerCase()));\n\n        if (\"t\".equals(opt.toLowerCase())) {\n            env = Environment.TEST;\n        } else {\n            env = Environment.PROD;\n        }\n\n        do {\n            System.out.println(\"Select the way you want your private key:\");\n            System.out.println(\"Press F for binary in a text file or T for plain text in your config file:\");\n            opt = scanner.next();\n        } while (\"f\".equals(opt.toLowerCase()) && \"t\".equals(opt.toLowerCase()));\n\n        if (\"f\".equals(opt.toLowerCase())) {\n            keyType = 1;\n        } else {\n            keyType = 2;\n        }\n\n        System.out.println(\"Generating private key... \");\n\n        try {\n            final File directory = new File(Paths.get(\".\").toAbsolutePath().normalize() + \"/output\");\n            if (!directory.exists()) {\n                directory.mkdir();\n            }\n\n            if (keyType == 1) {\n                privateKeyPath = Paths.get(\".\").toAbsolutePath().normalize()\n                    + \"/output/bitpay_private_\"\n                    + env.toString().toLowerCase()\n                    + \".key\";\n                if (!KeyUtils.privateKeyExists(privateKeyPath)) {\n                    final ECKey ecKey = KeyUtils.createEcKey();\n                    KeyUtils.saveEcKey(ecKey);\n                    KeyUtils.createEcKey();\n                    System.out.println(\"Private key generated successfully with public key:\");\n                    System.out.println(ecKey.getPublicKeyAsHex());\n                } else {\n                    KeyUtils.loadEcKey();\n                }\n                privateKey = privateKeyPath;\n            } else {\n                final ECKey ecKey = KeyUtils.createEcKey();\n                privateKeyAsHex = KeyUtils.loadEcKeyAsHex(ecKey);\n                System.out.println(\"Private key generated successfully with public key:\");\n                System.out.println(ecKey.getPublicKeyAsHex());\n                privateKey = privateKeyAsHex;\n            }\n        } catch (final Exception e) {\n            System.out.println(e.getMessage());\n            System.exit(0);\n        }\n\n        System.out.println(\"Generating config file... \");\n        try {\n            final ObjectMapper mapper = new ObjectMapper();\n\n            client = new Client(env, new PrivateKey(privateKey), new TokenContainer(), null, null);\n            pairingCodeMerchant = client.authorizeClient(Facade.MERCHANT);\n            pairingCodePayout = client.authorizeClient(Facade.PAYOUT);\n\n\n            final HashMap<String, String> tokens = new HashMap<>();\n            tokens.put(\"merchant\", client.getAccessToken(Facade.MERCHANT));\n            tokens.put(\"payout\", client.getAccessToken(Facade.PAYOUT));\n            final AtomicReference<JsonNode> ApiTokens = new AtomicReference<>(mapper.valueToTree(tokens));\n\n            final ObjectNode envConfig = mapper.createObjectNode();\n            envConfig.put(\"PrivateKeyPath\", privateKeyPath);\n            envConfig.put(\"PrivateKey\", privateKeyAsHex);\n            envConfig.put(\"ApiTokens\", ApiTokens.get());\n\n            final ObjectNode envTarget = mapper.createObjectNode();\n            envTarget.put(env.toString(), envConfig);\n\n            final ObjectNode bitPayConfiguration = mapper.createObjectNode();\n            bitPayConfiguration.put(\"Environment\", env.toString()).put(\"EnvConfig\", envTarget);\n\n            final ObjectNode configurationFile = mapper.createObjectNode();\n            configurationFile.put(\"BitPayConfiguration\", bitPayConfiguration);\n\n            final String jsonString = mapper.writerWithDefaultPrettyPrinter().writeValueAsString(configurationFile);\n\n            final ObjectWriter writer = mapper.writer(new DefaultPrettyPrinter());\n            writer.writeValue(\n                new File(Paths.get(\".\").toAbsolutePath().normalize() + \"/output/BitPay.config.json\"),\n                configurationFile);\n\n            System.out.println(\"In location:\");\n            System.out.println(Paths.get(\".\").toAbsolutePath().normalize() + \"/output/BitPay.config.json\");\n            System.out.println(\"With the following information:\");\n            System.out.println(jsonString);\n            System.out.println();\n            System.out.println(\n                \"To complete your setup, Go to \"\n                    + Config.TEST_URL\n                    + \"dashboard/merchant/api-tokens \"\n                    + \"and pair this client with your merchant account using the pairing codes:\"\n            );\n            System.out.println();\n            System.out.println(pairingCodeMerchant + \" for the Merchant facade.\");\n            System.out\n                .println(pairingCodePayout + \" for the Payout facade ONLY if you have requested access for this role.\");\n\n        } catch (final Exception e) {\n            System.out.println(e.getMessage());\n            System.exit(0);\n        }\n\n        System.out.println(\n            \"The private key and the config file is been generated in a directory called output\"\n                + \"in the root of this package.\"\n        );\n        System.out.println(\n            \"Make sure you store this key in a secure location and update the PrivateKeyPath\"\n                + \"in the generated config file.\"\n        );\n    }\n}\n\n'''\nThe error is caused by a change in the API of the dependency: bitcoinj-core 0.16.3->0.17. \nThe new library version includes the following relevant backward incompatible changes on API. \n(API changes format: lines starting with '--' denote removed members, '++' denote added ones, '~~' denote mutations with change kind) \n-- org.bitcoinj.core.ECKey\n-- org.bitcoinj.core.Base58\n-- org.bitcoinj.core.Sha256Hash\n++ public null org.bitcoinj.base.Sha256Hash\n++ public ECKey org.bitcoinj.crypto.ECKey()\n++ public Base58 org.bitcoinj.base.Base58()\n++ protected ECKey org.bitcoinj.crypto.ECKey(java.math.BigInteger,org.bouncycastle.math.ec.ECPoint,boolean)\n++ public null org.bitcoinj.crypto.ECKey\n++ public ECKey org.bitcoinj.crypto.ECKey(java.security.SecureRandom)\n++ protected ECKey org.bitcoinj.crypto.ECKey(java.math.BigInteger,org.bitcoinj.crypto.LazyECPoint)\n\nThe error is triggered in the following specific lines in the previous code:\nimport org.bitcoinj.core.ECKey;\n                    final ECKey ecKey = KeyUtils.createEcKey();\n                final ECKey ecKey = KeyUtils.createEcKey();\nwith the following error message:\n[ERROR] /java-bitpay-client/src/setup/java/BitPaySetup.java:[23,25] cannot find symbol  symbol:   class ECKey\n  location: package org.bitcoinj.core\n[ERROR] /java-bitpay-client/src/setup/java/BitPaySetup.java:[76,27] cannot find symbol  symbol:   class ECKey\n  location: class BitPaySetup\n[ERROR] /java-bitpay-client/src/setup/java/BitPaySetup.java:[86,23] cannot find symbol  symbol:   class ECKey\n  location: class BitPaySetup\n\nPlease apply your reasoning and generate the fix following the system instruction.\n",
    "buggy_lines": "import org.bitcoinj.core.ECKey;\n                    final ECKey ecKey = KeyUtils.createEcKey();\n                final ECKey ecKey = KeyUtils.createEcKey();",
    "error_message": "[ERROR] /java-bitpay-client/src/setup/java/BitPaySetup.java:[23,25] cannot find symbol  symbol:   class ECKey\n  location: package org.bitcoinj.core\n[ERROR] /java-bitpay-client/src/setup/java/BitPaySetup.java:[76,27] cannot find symbol  symbol:   class ECKey\n  location: class BitPaySetup\n[ERROR] /java-bitpay-client/src/setup/java/BitPaySetup.java:[86,23] cannot find symbol  symbol:   class ECKey\n  location: class BitPaySetup",
    "api_diff": "-- org.bitcoinj.core.ECKey\n-- org.bitcoinj.core.Base58\n-- org.bitcoinj.core.Sha256Hash\n++ public null org.bitcoinj.base.Sha256Hash\n++ public ECKey org.bitcoinj.crypto.ECKey()\n++ public Base58 org.bitcoinj.base.Base58()\n++ protected ECKey org.bitcoinj.crypto.ECKey(java.math.BigInteger,org.bouncycastle.math.ec.ECPoint,boolean)\n++ public null org.bitcoinj.crypto.ECKey\n++ public ECKey org.bitcoinj.crypto.ECKey(java.security.SecureRandom)\n++ protected ECKey org.bitcoinj.crypto.ECKey(java.math.BigInteger,org.bitcoinj.crypto.LazyECPoint)",
    "original_code": "/*\n * Copyright (c) 2019 BitPay.\n * All rights reserved.\n */\n\nimport com.bitpay.sdk.Client;\nimport com.bitpay.sdk.Config;\nimport com.bitpay.sdk.Environment;\nimport com.bitpay.sdk.PrivateKey;\nimport com.bitpay.sdk.model.Facade;\nimport com.bitpay.sdk.util.KeyUtils;\nimport com.bitpay.sdk.util.TokenContainer;\nimport com.fasterxml.jackson.core.util.DefaultPrettyPrinter;\nimport com.fasterxml.jackson.databind.JsonNode;\nimport com.fasterxml.jackson.databind.ObjectMapper;\nimport com.fasterxml.jackson.databind.ObjectWriter;\nimport com.fasterxml.jackson.databind.node.ObjectNode;\nimport java.io.File;\nimport java.nio.file.Paths;\nimport java.util.HashMap;\nimport java.util.Scanner;\nimport java.util.concurrent.atomic.AtomicReference;\nimport org.bitcoinj.core.ECKey;\n\npublic class BitPaySetup {\n    public static void main(final String[] args) {\n        final Scanner scanner = new Scanner(System.in);\n        String opt;\n        final Environment env;\n        String privateKeyPath = \"\";\n        String privateKeyAsHex = \"\";\n        final String pairingCodeMerchant;\n        final String pairingCodePayout;\n        String privateKey = \"\";\n        final int keyType; // 1 = in file, 2 = as text\n        final Client client;\n\n        do {\n            System.out.println(\"Select target environment:\");\n            System.out.println(\"Press T for testing or P for production:\");\n            opt = scanner.next();\n        } while (\"t\".equals(opt.toLowerCase()) && \"p\".equals(opt.toLowerCase()));\n\n        if (\"t\".equals(opt.toLowerCase())) {\n            env = Environment.TEST;\n        } else {\n            env = Environment.PROD;\n        }\n\n        do {\n            System.out.println(\"Select the way you want your private key:\");\n            System.out.println(\"Press F for binary in a text file or T for plain text in your config file:\");\n            opt = scanner.next();\n        } while (\"f\".equals(opt.toLowerCase()) && \"t\".equals(opt.toLowerCase()));\n\n        if (\"f\".equals(opt.toLowerCase())) {\n            keyType = 1;\n        } else {\n            keyType = 2;\n        }\n\n        System.out.println(\"Generating private key... \");\n\n        try {\n            final File directory = new File(Paths.get(\".\").toAbsolutePath().normalize() + \"/output\");\n            if (!directory.exists()) {\n                directory.mkdir();\n            }\n\n            if (keyType == 1) {\n                privateKeyPath = Paths.get(\".\").toAbsolutePath().normalize()\n                    + \"/output/bitpay_private_\"\n                    + env.toString().toLowerCase()\n                    + \".key\";\n                if (!KeyUtils.privateKeyExists(privateKeyPath)) {\n                    final ECKey ecKey = KeyUtils.createEcKey();\n                    KeyUtils.saveEcKey(ecKey);\n                    KeyUtils.createEcKey();\n                    System.out.println(\"Private key generated successfully with public key:\");\n                    System.out.println(ecKey.getPublicKeyAsHex());\n                } else {\n                    KeyUtils.loadEcKey();\n                }\n                privateKey = privateKeyPath;\n            } else {\n                final ECKey ecKey = KeyUtils.createEcKey();\n                privateKeyAsHex = KeyUtils.loadEcKeyAsHex(ecKey);\n                System.out.println(\"Private key generated successfully with public key:\");\n                System.out.println(ecKey.getPublicKeyAsHex());\n                privateKey = privateKeyAsHex;\n            }\n        } catch (final Exception e) {\n            System.out.println(e.getMessage());\n            System.exit(0);\n        }\n\n        System.out.println(\"Generating config file... \");\n        try {\n            final ObjectMapper mapper = new ObjectMapper();\n\n            client = new Client(env, new PrivateKey(privateKey), new TokenContainer(), null, null);\n            pairingCodeMerchant = client.authorizeClient(Facade.MERCHANT);\n            pairingCodePayout = client.authorizeClient(Facade.PAYOUT);\n\n\n            final HashMap<String, String> tokens = new HashMap<>();\n            tokens.put(\"merchant\", client.getAccessToken(Facade.MERCHANT));\n            tokens.put(\"payout\", client.getAccessToken(Facade.PAYOUT));\n            final AtomicReference<JsonNode> ApiTokens = new AtomicReference<>(mapper.valueToTree(tokens));\n\n            final ObjectNode envConfig = mapper.createObjectNode();\n            envConfig.put(\"PrivateKeyPath\", privateKeyPath);\n            envConfig.put(\"PrivateKey\", privateKeyAsHex);\n            envConfig.put(\"ApiTokens\", ApiTokens.get());\n\n            final ObjectNode envTarget = mapper.createObjectNode();\n            envTarget.put(env.toString(), envConfig);\n\n            final ObjectNode bitPayConfiguration = mapper.createObjectNode();\n            bitPayConfiguration.put(\"Environment\", env.toString()).put(\"EnvConfig\", envTarget);\n\n            final ObjectNode configurationFile = mapper.createObjectNode();\n            configurationFile.put(\"BitPayConfiguration\", bitPayConfiguration);\n\n            final String jsonString = mapper.writerWithDefaultPrettyPrinter().writeValueAsString(configurationFile);\n\n            final ObjectWriter writer = mapper.writer(new DefaultPrettyPrinter());\n            writer.writeValue(\n                new File(Paths.get(\".\").toAbsolutePath().normalize() + \"/output/BitPay.config.json\"),\n                configurationFile);\n\n            System.out.println(\"In location:\");\n            System.out.println(Paths.get(\".\").toAbsolutePath().normalize() + \"/output/BitPay.config.json\");\n            System.out.println(\"With the following information:\");\n            System.out.println(jsonString);\n            System.out.println();\n            System.out.println(\n                \"To complete your setup, Go to \"\n                    + Config.TEST_URL\n                    + \"dashboard/merchant/api-tokens \"\n                    + \"and pair this client with your merchant account using the pairing codes:\"\n            );\n            System.out.println();\n            System.out.println(pairingCodeMerchant + \" for the Merchant facade.\");\n            System.out\n                .println(pairingCodePayout + \" for the Payout facade ONLY if you have requested access for this role.\");\n\n        } catch (final Exception e) {\n            System.out.println(e.getMessage());\n            System.exit(0);\n        }\n\n        System.out.println(\n            \"The private key and the config file is been generated in a directory called output\"\n                + \"in the root of this package.\"\n        );\n        System.out.println(\n            \"Make sure you store this key in a secure location and update the PrivateKeyPath\"\n                + \"in the generated config file.\"\n        );\n    }\n}\n",
    "project": "java-bitpay-client",
    "libraryName": "bitcoinj-core",
    "libraryGroupID": "org.bitcoinj",
    "newVersion": "0.17",
    "previousVersion": "0.16.3",
    "breakingCommit": "de0a83ba9708170ae984b049781321f04caa82b3"
}