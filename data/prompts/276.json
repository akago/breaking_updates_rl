{
    "absolute_path_to_file_in_container": "/plexus-archiver/src/test/java/org/codehaus/plexus/archiver/DuplicateFilesTest.java",
    "errors": [
        {
            "line_number": 37,
            "message": "[ERROR] /plexus-archiver/src/test/java/org/codehaus/plexus/archiver/DuplicateFilesTest.java:[37,23] cannot find symbol",
            "additional_info": "  symbol:   method getLoggerManager()\n  location: interface org.codehaus.plexus.PlexusContainer",
            "file_name": "DuplicateFilesTest.java",
            "BCs": [],
            "Additions": [],
            "uid": "c2a0697d-4fa2-5745-af99-82b067f07635"
        }
    ],
    "prompt": "\nThe following Java client code fails: \n'''java\npackage org.codehaus.plexus.archiver;\n\nimport java.io.BufferedInputStream;\nimport java.io.BufferedReader;\nimport java.io.File;\nimport java.io.FileInputStream;\nimport java.io.FileReader;\nimport java.nio.charset.StandardCharsets;\nimport java.nio.file.Files;\nimport java.util.Enumeration;\n\nimport org.apache.commons.compress.archivers.tar.TarArchiveInputStream;\nimport org.apache.commons.compress.archivers.zip.ZipArchiveEntry;\nimport org.codehaus.plexus.PlexusTestCase;\nimport org.codehaus.plexus.archiver.tar.TarArchiver;\nimport org.codehaus.plexus.archiver.tar.TarLongFileMode;\nimport org.codehaus.plexus.logging.Logger;\nimport org.codehaus.plexus.util.FileUtils;\n\n/**\n * @author Erik Engstrom\n */\npublic class DuplicateFilesTest\n    extends PlexusTestCase\n{\n\n    private static final File file1 = getTestFile( \"src/test/resources/group-writable/foo.txt\" );\n\n    private static final File file2 = getTestFile( \"src/test/resources/world-writable/foo.txt\" );\n\n    private static final File destination = getTestFile( \"target/output/duplicateFiles\" );\n\n    public void setUp()\n        throws Exception\n    {\n        super.setUp();\n        getContainer().getLoggerManager().setThreshold( Logger.LEVEL_DEBUG );\n    }\n\n    public void testZipArchiver()\n        throws Exception\n    {\n        Archiver archiver = (Archiver) lookup( Archiver.ROLE, \"zip\" );\n        archiver.setDuplicateBehavior( Archiver.DUPLICATES_SKIP );\n\n        File archive = createArchive( archiver, \"zip\" );\n\n        org.apache.commons.compress.archivers.zip.ZipFile zf =\n            new org.apache.commons.compress.archivers.zip.ZipFile( archive );\n\n        Enumeration<ZipArchiveEntry> e = zf.getEntries();\n        int entryCount = 0;\n        while ( e.hasMoreElements() )\n        {\n            ZipArchiveEntry entry = e.nextElement();\n            System.out.println( entry.getName() );\n            entryCount++;\n        }\n        zf.close();\n\n        // Zip file should have 2 entries, 1 for the directory and one for foo.txt\n        assertEquals( 2, entryCount );\n        testArchive( archive, \"zip\" );\n    }\n\n    public void testDirArchiver()\n        throws Exception\n    {\n        Archiver archiver = (Archiver) lookup( Archiver.ROLE, \"dir\" );\n        createArchive( archiver, \"dir\" );\n        testFinalFile( \"target/output/duplicateFiles.dir/duplicateFiles/foo.txt\" );\n\n    }\n\n    public void testTarArchiver()\n        throws Exception\n    {\n        TarArchiver archiver = (TarArchiver) lookup( Archiver.ROLE, \"tar\" );\n        archiver.setLongfile( TarLongFileMode.posix );\n        archiver.setDuplicateBehavior( Archiver.DUPLICATES_SKIP );\n\n        File archive = createArchive( archiver, \"tar\" );\n        TarArchiveInputStream tis;\n\n        tis = new TarArchiveInputStream( new BufferedInputStream( Files.newInputStream( archive.toPath() ) ) );\n        int entryCount = 0;\n        while ( ( tis.getNextEntry() ) != null )\n        {\n            entryCount++;\n        }\n        assertEquals( 1, entryCount );\n        testArchive( archive, \"tar\" );\n        tis.close();\n    }\n\n    private File createArchive( Archiver archiver, String outputFileExt )\n        throws Exception\n    {\n        archiver.addFile( file1, \"duplicateFiles/foo.txt\" );\n        archiver.addFile( file2, \"duplicateFiles/foo.txt\" );\n\n        // delete it if it exists to ensure it is actually empty\n        if ( destination.exists() )\n        {\n            destination.delete();\n        }\n\n        File archive = getTestFile( \"target/output/duplicateFiles.\" + outputFileExt );\n        if ( archive.exists() )\n        {\n            if ( archive.isDirectory() )\n            {\n                FileUtils.deleteDirectory( archive );\n            }\n            else\n            {\n                archive.delete();\n            }\n        }\n\n        archiver.setDestFile( archive );\n        archiver.createArchive();\n        return archive;\n    }\n\n    private void testArchive( File archive, String role )\n        throws Exception\n    {\n        // Check the content of the archive by extracting it\n\n        UnArchiver unArchiver = (UnArchiver) lookup( UnArchiver.ROLE, role );\n        unArchiver.setSourceFile( archive );\n\n        unArchiver.setDestDirectory( getTestFile( \"target/output/\" ) );\n        unArchiver.extract();\n\n        assertTrue( destination.exists() );\n        assertTrue( destination.isDirectory() );\n        testFinalFile( \"target/output/duplicateFiles/foo.txt\" );\n    }\n\n    private void testFinalFile( String path )\n        throws Exception\n    {\n        File outputFile = getTestFile( path );\n        assertTrue( outputFile.exists() );\n        BufferedReader reader = Files.newBufferedReader( outputFile.toPath(), StandardCharsets.UTF_8 );\n        String firstLine = reader.readLine();\n        reader.close();\n        reader = Files.newBufferedReader( file2.toPath(), StandardCharsets.UTF_8 );\n        String expectedFirstLine = reader.readLine();\n        reader.close();\n        assertEquals( expectedFirstLine, firstLine );\n    }\n\n}\n\n'''\nThe error is caused by a change in the API of the dependency: plexus-container-default 1.0-alpha-30->2.1.1. \nThe new library version includes the following relevant backward incompatible changes on API. \n(API changes format: lines starting with '--' denote removed members, '++' denote added ones, '~~' denote mutations with change kind) \n\n\nThe error is triggered in the following specific lines in the previous code:\n        getContainer().getLoggerManager().setThreshold( Logger.LEVEL_DEBUG );\nwith the following error message:\n[ERROR] /plexus-archiver/src/test/java/org/codehaus/plexus/archiver/DuplicateFilesTest.java:[37,23] cannot find symbol  symbol:   method getLoggerManager()\n  location: interface org.codehaus.plexus.PlexusContainer\n\nPlease apply your reasoning and generate the fix following the system instruction.\n",
    "buggy_lines": "        getContainer().getLoggerManager().setThreshold( Logger.LEVEL_DEBUG );",
    "error_message": "[ERROR] /plexus-archiver/src/test/java/org/codehaus/plexus/archiver/DuplicateFilesTest.java:[37,23] cannot find symbol  symbol:   method getLoggerManager()\n  location: interface org.codehaus.plexus.PlexusContainer",
    "api_diff": "",
    "original_code": "package org.codehaus.plexus.archiver;\n\nimport java.io.BufferedInputStream;\nimport java.io.BufferedReader;\nimport java.io.File;\nimport java.io.FileInputStream;\nimport java.io.FileReader;\nimport java.nio.charset.StandardCharsets;\nimport java.nio.file.Files;\nimport java.util.Enumeration;\n\nimport org.apache.commons.compress.archivers.tar.TarArchiveInputStream;\nimport org.apache.commons.compress.archivers.zip.ZipArchiveEntry;\nimport org.codehaus.plexus.PlexusTestCase;\nimport org.codehaus.plexus.archiver.tar.TarArchiver;\nimport org.codehaus.plexus.archiver.tar.TarLongFileMode;\nimport org.codehaus.plexus.logging.Logger;\nimport org.codehaus.plexus.util.FileUtils;\n\n/**\n * @author Erik Engstrom\n */\npublic class DuplicateFilesTest\n    extends PlexusTestCase\n{\n\n    private static final File file1 = getTestFile( \"src/test/resources/group-writable/foo.txt\" );\n\n    private static final File file2 = getTestFile( \"src/test/resources/world-writable/foo.txt\" );\n\n    private static final File destination = getTestFile( \"target/output/duplicateFiles\" );\n\n    public void setUp()\n        throws Exception\n    {\n        super.setUp();\n        getContainer().getLoggerManager().setThreshold( Logger.LEVEL_DEBUG );\n    }\n\n    public void testZipArchiver()\n        throws Exception\n    {\n        Archiver archiver = (Archiver) lookup( Archiver.ROLE, \"zip\" );\n        archiver.setDuplicateBehavior( Archiver.DUPLICATES_SKIP );\n\n        File archive = createArchive( archiver, \"zip\" );\n\n        org.apache.commons.compress.archivers.zip.ZipFile zf =\n            new org.apache.commons.compress.archivers.zip.ZipFile( archive );\n\n        Enumeration<ZipArchiveEntry> e = zf.getEntries();\n        int entryCount = 0;\n        while ( e.hasMoreElements() )\n        {\n            ZipArchiveEntry entry = e.nextElement();\n            System.out.println( entry.getName() );\n            entryCount++;\n        }\n        zf.close();\n\n        // Zip file should have 2 entries, 1 for the directory and one for foo.txt\n        assertEquals( 2, entryCount );\n        testArchive( archive, \"zip\" );\n    }\n\n    public void testDirArchiver()\n        throws Exception\n    {\n        Archiver archiver = (Archiver) lookup( Archiver.ROLE, \"dir\" );\n        createArchive( archiver, \"dir\" );\n        testFinalFile( \"target/output/duplicateFiles.dir/duplicateFiles/foo.txt\" );\n\n    }\n\n    public void testTarArchiver()\n        throws Exception\n    {\n        TarArchiver archiver = (TarArchiver) lookup( Archiver.ROLE, \"tar\" );\n        archiver.setLongfile( TarLongFileMode.posix );\n        archiver.setDuplicateBehavior( Archiver.DUPLICATES_SKIP );\n\n        File archive = createArchive( archiver, \"tar\" );\n        TarArchiveInputStream tis;\n\n        tis = new TarArchiveInputStream( new BufferedInputStream( Files.newInputStream( archive.toPath() ) ) );\n        int entryCount = 0;\n        while ( ( tis.getNextEntry() ) != null )\n        {\n            entryCount++;\n        }\n        assertEquals( 1, entryCount );\n        testArchive( archive, \"tar\" );\n        tis.close();\n    }\n\n    private File createArchive( Archiver archiver, String outputFileExt )\n        throws Exception\n    {\n        archiver.addFile( file1, \"duplicateFiles/foo.txt\" );\n        archiver.addFile( file2, \"duplicateFiles/foo.txt\" );\n\n        // delete it if it exists to ensure it is actually empty\n        if ( destination.exists() )\n        {\n            destination.delete();\n        }\n\n        File archive = getTestFile( \"target/output/duplicateFiles.\" + outputFileExt );\n        if ( archive.exists() )\n        {\n            if ( archive.isDirectory() )\n            {\n                FileUtils.deleteDirectory( archive );\n            }\n            else\n            {\n                archive.delete();\n            }\n        }\n\n        archiver.setDestFile( archive );\n        archiver.createArchive();\n        return archive;\n    }\n\n    private void testArchive( File archive, String role )\n        throws Exception\n    {\n        // Check the content of the archive by extracting it\n\n        UnArchiver unArchiver = (UnArchiver) lookup( UnArchiver.ROLE, role );\n        unArchiver.setSourceFile( archive );\n\n        unArchiver.setDestDirectory( getTestFile( \"target/output/\" ) );\n        unArchiver.extract();\n\n        assertTrue( destination.exists() );\n        assertTrue( destination.isDirectory() );\n        testFinalFile( \"target/output/duplicateFiles/foo.txt\" );\n    }\n\n    private void testFinalFile( String path )\n        throws Exception\n    {\n        File outputFile = getTestFile( path );\n        assertTrue( outputFile.exists() );\n        BufferedReader reader = Files.newBufferedReader( outputFile.toPath(), StandardCharsets.UTF_8 );\n        String firstLine = reader.readLine();\n        reader.close();\n        reader = Files.newBufferedReader( file2.toPath(), StandardCharsets.UTF_8 );\n        String expectedFirstLine = reader.readLine();\n        reader.close();\n        assertEquals( expectedFirstLine, firstLine );\n    }\n\n}\n",
    "project": "plexus-archiver",
    "libraryName": "plexus-container-default",
    "libraryGroupID": "org.codehaus.plexus",
    "newVersion": "2.1.1",
    "previousVersion": "1.0-alpha-30",
    "breakingCommit": "3ff575ae202cdf76ddfa8a4228a1711a6fa1e921"
}